"use strict";(self["webpackChunkwbs_2025"]=self["webpackChunkwbs_2025"]||[]).push([[101],{2982:function(e,s,t){t.r(s),t.d(s,{default:function(){return c}});t(8111),t(2489),t(1701);var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"manage-users-page"},[s("div",{staticClass:"page-header bg-white shadow-sm border-b border-gray-200 mb-6"},[s("div",{staticClass:"px-6 py-4"},[s("div",{staticClass:"flex items-center justify-between"},[e._m(0),s("button",{staticClass:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",on:{click:function(s){e.showAddUserModal=!0}}},[s("Icon",{staticClass:"mr-2 h-4 w-4",attrs:{icon:"mdi:account-plus"}}),e._v(" Tambah User ")],1)])])]),s("div",{staticClass:"px-6 mb-6"},[s("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[s("div",{staticClass:"grid grid-cols-1 md:grid-cols-3 gap-4"},[s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v("Cari User")]),s("div",{staticClass:"relative"},[s("Icon",{staticClass:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4",attrs:{icon:"mdi:magnify"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"pl-10 w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",placeholder:"Nama, email, atau username..."},domProps:{value:e.searchQuery},on:{input:function(s){s.target.composing||(e.searchQuery=s.target.value)}}})],1)]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v("Filter Role")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedRole,expression:"selectedRole"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){var s="_value"in e?e._value:e.value;return s});e.selectedRole=s.target.multiple?t:t[0]}}},[s("option",{attrs:{value:""}},[e._v("Semua Role")]),s("option",{attrs:{value:"User"}},[e._v("User")]),s("option",{attrs:{value:"Moderator"}},[e._v("Moderator")]),s("option",{attrs:{value:"Admin"}},[e._v("Admin")])])]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v("Status")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedStatus,expression:"selectedStatus"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){var s="_value"in e?e._value:e.value;return s});e.selectedStatus=s.target.multiple?t:t[0]}}},[s("option",{attrs:{value:""}},[e._v("Semua Status")]),s("option",{attrs:{value:"true"}},[e._v("Aktif")]),s("option",{attrs:{value:"false"}},[e._v("Tidak Aktif")])])])])])]),s("div",{staticClass:"px-6"},[s("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},[s("div",{staticClass:"px-4 py-3 border-b border-gray-200 bg-gray-50"},[s("h3",{staticClass:"text-lg font-medium text-gray-900"},[e._v("Daftar User ("+e._s(e.filteredUsers.length)+")")])]),s("div",{staticClass:"overflow-x-auto"},[e.loading?s("div",{staticClass:"flex justify-center items-center py-12"},[s("div",{staticClass:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s("span",{staticClass:"ml-2 text-gray-600"},[e._v("Memuat data pengguna...")])]):s("table",{staticClass:"min-w-full divide-y divide-gray-200"},[e._m(1),s("tbody",{staticClass:"bg-white divide-y divide-gray-200"},e._l(e.filteredUsers,function(t){return s("tr",{key:t.id,staticClass:"hover:bg-gray-50"},[s("td",{staticClass:"px-6 py-4 whitespace-nowrap"},[s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"flex-shrink-0 h-10 w-10"},[s("div",{staticClass:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center"},[s("span",{staticClass:"text-sm font-medium text-white"},[e._v(e._s(t.initials))])])]),s("div",{staticClass:"ml-4"},[s("div",{staticClass:"text-sm font-medium text-gray-900"},[e._v(e._s(t.full_name))]),s("div",{staticClass:"text-sm text-gray-500"},[e._v(e._s(t.email))]),s("div",{staticClass:"text-xs text-gray-400"},[e._v("@"+e._s(t.username))])])])]),s("td",{staticClass:"px-6 py-4 whitespace-nowrap"},e._l(t.roles,function(t){return s("span",{key:t,staticClass:"inline-flex items-center mr-0.5 px-2.5 py-0.5 rounded-full text-xs font-medium",class:e.getRoleBadgeClass(t)},[e._v(" "+e._s(e.getRoleLabel(t))+" ")])}),0),s("td",{staticClass:"px-6 py-4 whitespace-nowrap"},[s("span",{staticClass:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",class:e.getStatusBadgeClass(t.status)},[e._v(" "+e._s(e.getStatusLabel(t.status))+" ")])]),s("td",{staticClass:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},[e._v(" "+e._s(e.formatDate(t.createdAt))+" ")]),s("td",{staticClass:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},[e._v(" "+e._s(e.formatRelativeTime(t.lastActivity))+" ")]),s("td",{staticClass:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},[s("div",{staticClass:"flex items-center justify-end space-x-2"},[s("button",{class:t.status?"text-green-600 hover:text-green-900":"text-red-600 hover:text-red-900",attrs:{title:t.status?"Nonaktifkan User":"Aktifkan User"},on:{click:function(s){return e.toggleUserStatus(t)}}},[s("Icon",{staticClass:"h-4 w-4",attrs:{icon:"active"===t.status?"mdi:account-off":"mdi:account-check"}})],1),s("button",{staticClass:"text-purple-600 hover:text-purple-900",attrs:{title:"Assign Role"},on:{click:function(s){return e.assignRole(t)}}},[s("Icon",{staticClass:"h-4 w-4",attrs:{icon:"mdi:account-badge"}})],1),s("button",{class:t.roles&&Array.isArray(t.roles)&&0!==t.roles.filter(e=>"USER"!==e).length?"text-orange-600 hover:text-orange-900":"text-gray-400 cursor-not-allowed",attrs:{title:t.roles&&Array.isArray(t.roles)&&0!==t.roles.filter(e=>"USER"!==e).length?"Remove Role":"Tidak ada role yang dapat dihapus",disabled:!t.roles||!Array.isArray(t.roles)||0===t.roles.filter(e=>"USER"!==e).length},on:{click:function(s){return e.removeRole(t)}}},[s("Icon",{staticClass:"h-4 w-4",attrs:{icon:"mdi:account-badge-outline"}})],1)])])])}),0)])]),e.loading||0!==e.filteredUsers.length?e._e():s("div",{staticClass:"text-center py-12"},[s("Icon",{staticClass:"mx-auto h-12 w-12 text-gray-400",attrs:{icon:"mdi:account-search"}}),s("h3",{staticClass:"mt-2 text-sm font-medium text-gray-900"},[e._v("Tidak ada user ditemukan")]),s("p",{staticClass:"mt-1 text-sm text-gray-500"},[e._v("Coba ubah filter pencarian atau tambah user baru.")])],1)])]),e.showAddUserModal?s("div",{staticClass:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},[s("div",{staticClass:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},[s("div",{staticClass:"mt-3"},[s("div",{staticClass:"flex items-center justify-between mb-4"},[s("h3",{staticClass:"text-lg font-medium text-gray-900"},[e._v("Tambah User Baru")]),s("button",{staticClass:"text-gray-400 hover:text-gray-600",on:{click:function(s){e.showAddUserModal=!1}}},[s("Icon",{staticClass:"h-5 w-5",attrs:{icon:"mdi:close"}})],1)]),s("form",{staticClass:"space-y-4",on:{submit:function(s){return s.preventDefault(),e.addUser.apply(null,arguments)}}},[s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Nama Lengkap")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.name,expression:"newUser.name"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",required:"",placeholder:"Masukkan nama lengkap"},domProps:{value:e.newUser.name},on:{input:function(s){s.target.composing||e.$set(e.newUser,"name",s.target.value)}}})]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Email")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.email,expression:"newUser.email"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"email",required:"",placeholder:"user@example.com"},domProps:{value:e.newUser.email},on:{input:function(s){s.target.composing||e.$set(e.newUser,"email",s.target.value)}}})]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Username")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.username,expression:"newUser.username"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",required:"",placeholder:"username"},domProps:{value:e.newUser.username},on:{input:function(s){s.target.composing||e.$set(e.newUser,"username",s.target.value)}}})]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Role")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.newUser.role,expression:"newUser.role"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{required:""},on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){var s="_value"in e?e._value:e.value;return s});e.$set(e.newUser,"role",s.target.multiple?t:t[0])}}},[s("option",{attrs:{value:""}},[e._v("Pilih Role")]),s("option",{attrs:{value:"reporter"}},[e._v("Reporter")]),s("option",{attrs:{value:"admin"}},[e._v("Admin")]),s("option",{attrs:{value:"super_admin"}},[e._v("Super Admin")])])]),s("div",{staticClass:"flex justify-end space-x-3 pt-4"},[s("button",{staticClass:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",attrs:{type:"button"},on:{click:function(s){e.showAddUserModal=!1}}},[e._v(" Batal ")]),s("button",{staticClass:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",attrs:{type:"submit",disabled:e.loading}},[e.loading?s("div",{staticClass:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e._e(),e._v(" "+e._s(e.loading?"Menambahkan...":"Tambah User")+" ")])])])])])]):e._e(),e.showResetPasswordModal?s("div",{staticClass:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},[s("div",{staticClass:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},[s("div",{staticClass:"mt-3"},[s("div",{staticClass:"flex items-center justify-between mb-4"},[s("h3",{staticClass:"text-lg font-medium text-gray-900"},[e._v("Reset Password")]),s("button",{staticClass:"text-gray-400 hover:text-gray-600",on:{click:e.closeResetPasswordModal}},[s("Icon",{staticClass:"h-5 w-5",attrs:{icon:"mdi:close"}})],1)]),s("div",{staticClass:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md"},[s("div",{staticClass:"flex items-center"},[s("Icon",{staticClass:"h-5 w-5 text-blue-600 mr-2",attrs:{icon:"mdi:account"}}),s("span",{staticClass:"text-sm text-blue-800"},[e._v(" Reset password untuk: "),s("strong",[e._v(e._s(e.selectedUser?.name))])])],1)]),s("form",{staticClass:"space-y-4",on:{submit:function(s){return s.preventDefault(),e.submitPasswordReset.apply(null,arguments)}}},[s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Password Saat Ini")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.currentPassword,expression:"passwordForm.currentPassword"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"password",required:"",placeholder:"Masukkan password saat ini"},domProps:{value:e.passwordForm.currentPassword},on:{input:function(s){s.target.composing||e.$set(e.passwordForm,"currentPassword",s.target.value)}}})]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Password Baru")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.newPassword,expression:"passwordForm.newPassword"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"password",required:"",placeholder:"Masukkan password baru (min. 6 karakter)"},domProps:{value:e.passwordForm.newPassword},on:{input:function(s){s.target.composing||e.$set(e.passwordForm,"newPassword",s.target.value)}}})]),s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Konfirmasi Password Baru")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.confirmPassword,expression:"passwordForm.confirmPassword"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",attrs:{type:"password",required:"",placeholder:"Masukkan ulang password baru"},domProps:{value:e.passwordForm.confirmPassword},on:{input:function(s){s.target.composing||e.$set(e.passwordForm,"confirmPassword",s.target.value)}}})]),s("div",{staticClass:"flex justify-end space-x-3 pt-4"},[s("button",{staticClass:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",attrs:{type:"button"},on:{click:e.closeResetPasswordModal}},[e._v(" Batal ")]),s("button",{staticClass:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",attrs:{type:"submit",disabled:e.loading}},[e.loading?s("div",{staticClass:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e._e(),s("Icon",{staticClass:"h-4 w-4 mr-2",attrs:{icon:"mdi:key-variant"}}),e._v(" "+e._s(e.loading?"Mereset...":"Reset Password")+" ")],1)])])])])]):e._e(),e.showAssignRoleModal?s("div",{staticClass:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},[s("div",{staticClass:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},[s("div",{staticClass:"mt-3"},[s("div",{staticClass:"flex items-center justify-between mb-4"},[s("h3",{staticClass:"text-lg font-medium text-gray-900"},[e._v("Assign Role")]),s("button",{staticClass:"text-gray-400 hover:text-gray-600",on:{click:e.closeAssignRoleModal}},[s("Icon",{staticClass:"h-5 w-5",attrs:{icon:"mdi:close"}})],1)]),s("div",{staticClass:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-md"},[s("div",{staticClass:"flex items-center"},[s("Icon",{staticClass:"h-5 w-5 text-purple-600 mr-2",attrs:{icon:"mdi:account-badge"}}),s("span",{staticClass:"text-sm text-purple-800"},[e._v(" Ubah role untuk: "),s("strong",[e._v(e._s(e.selectedUser?.name))])])],1),s("div",{staticClass:"mt-2 text-xs text-purple-700"},[e._v(" Role saat ini: "),s("span",{staticClass:"font-medium"},[e._v(e._s(e.getRoleLabel(e.selectedUser?.role)))])])]),s("form",{staticClass:"space-y-4",on:{submit:function(s){return s.preventDefault(),e.submitRoleAssignment.apply(null,arguments)}}},[s("div",[s("label",{staticClass:"block text-sm font-medium text-gray-700 mb-1"},[e._v("Role Baru")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.assignRoleForm.selectedRole,expression:"assignRoleForm.selectedRole"}],staticClass:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",attrs:{required:""},on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){var s="_value"in e?e._value:e.value;return s});e.$set(e.assignRoleForm,"selectedRole",s.target.multiple?t:t[0])}}},[s("option",{attrs:{value:""}},[e._v("Pilih Role")]),e._l(e.availableRoles,function(t){return s("option",{key:t.value,attrs:{disabled:t.value===e.selectedUser?.role},domProps:{value:t.value}},[e._v(" "+e._s(t.label)+" "),t.value===e.selectedUser?.role?s("span",[e._v(" (Current)")]):e._e()])})],2)]),s("div",{staticClass:"flex justify-end space-x-3 pt-4"},[s("button",{staticClass:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",attrs:{type:"button"},on:{click:e.closeAssignRoleModal}},[e._v(" Batal ")]),s("button",{staticClass:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",attrs:{type:"submit",disabled:e.loading}},[e.loading?s("div",{staticClass:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e._e(),s("Icon",{staticClass:"h-4 w-4 mr-2",attrs:{icon:"mdi:account-badge"}}),e._v(" "+e._s(e.loading?"Mengubah...":"Assign Role")+" ")],1)])])])])]):e._e()])},r=[function(){var e=this,s=e._self._c;return s("div",[s("h1",{staticClass:"text-2xl font-bold text-gray-900"},[e._v("Kelola User")]),s("p",{staticClass:"mt-1 text-sm text-gray-600"},[e._v("Mengelola akun pengguna sistem")])])},function(){var e=this,s=e._self._c;return s("thead",{staticClass:"bg-gray-50"},[s("tr",[s("th",{staticClass:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("User")]),s("th",{staticClass:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("Role")]),s("th",{staticClass:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("Status")]),s("th",{staticClass:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("Terdaftar")]),s("th",{staticClass:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("Aktivitas Terakhir")]),s("th",{staticClass:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},[e._v("Aksi")])])])}],o=t(8298),i=t(1910),n={name:"ManageUsers",components:{Icon:o.In},data(){return{searchQuery:"",selectedRole:"",selectedStatus:"",showAddUserModal:!1,showResetPasswordModal:!1,showAssignRoleModal:!1,selectedUser:null,newUser:{name:"",email:"",username:"",role:""},passwordForm:{currentPassword:"",newPassword:"",confirmPassword:""},assignRoleForm:{selectedRole:""},availableRoles:[{value:"user",label:"User"},{value:"moderator",label:"Moderator"},{value:"admin",label:"Admin"}],users:[],loading:!1}},computed:{filteredUsers(){return this.users.filter(e=>{const s=!this.searchQuery||e.name?.toLowerCase().includes(this.searchQuery.toLowerCase())||e.email?.toLowerCase().includes(this.searchQuery.toLowerCase())||e.username?.toLowerCase().includes(this.searchQuery.toLowerCase())||e.full_name?.toLowerCase().includes(this.searchQuery.toLowerCase()),t=!this.selectedRole||e.role===this.selectedRole,a=!this.selectedStatus||e.status===this.selectedStatus;return s||t||a})}},mounted(){this.loadUsers()},methods:{...(0,i.i0)(["fetchUsers","createUser","updateUser","deleteUser","toggleUserStatus","resetPassword","assignRoleToUser","removeRoleFromUser"]),async loadUsers(){try{this.loading=!0;const e=await this.$store.dispatch("fetchUsers");console.log("API Response:",e);let s=[];e&&e.data?Array.isArray(e.data)?s=e.data:e.data.users&&Array.isArray(e.data.users)?s=e.data.users:e.data.data&&Array.isArray(e.data.data)&&(s=e.data.data):Array.isArray(e)&&(s=e),this.users=s.map(e=>({id:e.id,name:e.firstName||"Unknown User",full_name:e.firstName+" "+e.lastName||"Unknown User",email:e.email||"",username:e.username||"",roles:e.roles||"Unknown Role",status:e.isEnabled,initials:this.generateInitials(e.firstName||"Unknown User"),createdAt:e.created_at||e.createdAt||(new Date).toISOString(),lastActivity:e.lastLogin||null})),console.log("Processed users:",this.users)}catch(e){console.error("Error loading users:",e),this.$message.error("Gagal memuat data pengguna"),this.users=[{id:1,name:"System Administrator",full_name:"System Administrator",email:"admin@example.com",username:"admin",role:"admin",status:"active",initials:"SA",createdAt:"2024-01-15",lastActivity:"2024-01-20T10:30:00"},{id:2,name:"Reporter User",full_name:"Reporter User",email:"reporter@example.com",username:"reporter",role:"reporter",status:"active",initials:"RU",createdAt:"2024-01-10",lastActivity:"2024-01-20T09:15:00"}]}finally{this.loading=!1}},generateInitials(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"UN"},getRoleLabel(e){const s={USER:"User",MODERATOR:"Moderator",ADMIN:"Admin"};return s[e]||e},getRoleBadgeClass(e){const s={USER:"bg-green-100 text-green-800",MODERATOR:"bg-blue-100 text-blue-800",ADMIN:"bg-purple-100 text-purple-800"};return s[e]||"bg-gray-100 text-gray-800"},getStatusLabel(e){const s={true:"Active",false:"Inactive",suspended:"Disuspend",pending:"Menunggu Verifikasi"};return s[e]||e},getStatusBadgeClass(e){const s={true:"bg-green-100 text-green-800",false:"bg-red-100 text-red-800",suspended:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};return s[e]||"bg-gray-100 text-gray-800"},formatDate(e){return e?new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"},formatRelativeTime(e){if(!e)return"Belum pernah";const s=new Date,t=new Date(e),a=Math.floor((s-t)/36e5);if(a<1)return"Baru saja";if(a<24)return`${a} jam lalu`;const r=Math.floor(a/24);return r<7?`${r} hari lalu`:this.formatDate(e)},async addUser(){try{this.loading=!0;const e={username:this.newUser.username,email:this.newUser.email,full_name:this.newUser.name,role:this.newUser.role,password:"defaultpassword123"};console.log("Creating user with data:",e);const s=await this.$store.dispatch("createUser",e);console.log("Create user response:",s),this.$message.success("User berhasil ditambahkan"),this.showAddUserModal=!1,this.newUser={name:"",email:"",username:"",role:""},await this.loadUsers()}catch(e){console.error("Error adding user:",e);let s="Gagal menambahkan user";e.response&&e.response.data&&e.response.data.message?s=e.response.data.message:e.message&&"Invalid response format"!==e.message&&(s=e.message),this.$message.error(s)}finally{this.loading=!1}},editUser(e){this.$message.info(`Edit user: ${e.name} - Fitur akan segera hadir`)},async toggleUserStatus(e){try{const s=!0===e.status?"menonaktifkan":"mengaktifkan";await this.$confirm(`Apakah Anda yakin ingin ${s} pengguna ${e.name}?`,"Konfirmasi",{confirmButtonText:"Ya",cancelButtonText:"Batal",type:"warning"}),console.log(`Toggling user ${e.id} status via API`);const t=await this.$store.dispatch("toggleUserStatus",e.id);console.log("Toggle status response:",t),this.$message.success(`Status user ${e.name} berhasil diubah`),await this.loadUsers()}catch(s){if("cancel"!==s){console.error("Error toggling user status:",s);let e="Gagal mengubah status user";s.response&&s.response.data&&s.response.data.message?e=s.response.data.message:s.message&&"Invalid response format"!==s.message&&(e=s.message),this.$message.error(e)}}},resetPassword(e){this.selectedUser=e,this.passwordForm={currentPassword:"",newPassword:"",confirmPassword:""},this.showResetPasswordModal=!0},async submitPasswordReset(){try{if(!this.passwordForm.currentPassword)return void this.$message.error("Password saat ini harus diisi");if(!this.passwordForm.newPassword)return void this.$message.error("Password baru harus diisi");if(this.passwordForm.newPassword!==this.passwordForm.confirmPassword)return void this.$message.error("Konfirmasi password tidak cocok");if(this.passwordForm.newPassword.length<6)return void this.$message.error("Password baru minimal 6 karakter");console.log(`Resetting password for user: ${this.selectedUser.name}`);const e=await this.$store.dispatch("resetPassword",{currentPassword:this.passwordForm.currentPassword,newPassword:this.passwordForm.newPassword,confirmPassword:this.passwordForm.confirmPassword});console.log("Password reset response:",e),this.$message.success(`Password untuk ${this.selectedUser.name} berhasil direset`),this.showResetPasswordModal=!1,this.selectedUser=null}catch(e){console.error("Error resetting password:",e);let s="Gagal mereset password";e.response&&e.response.data&&e.response.data.message?s=e.response.data.message:e.message&&"Invalid response format"!==e.message&&(s=e.message),this.$message.error(s)}},closeResetPasswordModal(){this.showResetPasswordModal=!1,this.selectedUser=null,this.passwordForm={currentPassword:"",newPassword:"",confirmPassword:""}},assignRole(e){this.selectedUser=e,this.assignRoleForm={selectedRole:e.role},this.showAssignRoleModal=!0},async submitRoleAssignment(){try{if(!this.assignRoleForm.selectedRole)return void this.$message.error("Role harus dipilih");if(this.assignRoleForm.selectedRole===this.selectedUser.role)return void this.$message.warning("Role yang dipilih sama dengan role saat ini");console.log(`Assigning role ${this.assignRoleForm.selectedRole} to user: ${this.selectedUser.name}`);const e=await this.$store.dispatch("assignRoleToUser",{userId:this.selectedUser.id,roleName:this.assignRoleForm.selectedRole});console.log("Role assignment response:",e),this.$message.success(`Role ${this.getRoleLabel(this.assignRoleForm.selectedRole)} berhasil diberikan kepada ${this.selectedUser.name}`),this.showAssignRoleModal=!1,this.selectedUser=null,await this.loadUsers()}catch(e){console.error("Error assigning role:",e);let s="Gagal mengubah role user";e.response&&e.response.data&&e.response.data.message?s=e.response.data.message:e.message&&"Invalid response format"!==e.message&&(s=e.message),this.$message.error(s)}},closeAssignRoleModal(){this.showAssignRoleModal=!1,this.selectedUser=null,this.assignRoleForm={selectedRole:""}},async deleteUser(e){try{await this.$confirm(`Apakah Anda yakin ingin menghapus user ${e.name}? Tindakan ini tidak dapat dibatalkan.`,"Konfirmasi Hapus",{confirmButtonText:"Hapus",cancelButtonText:"Batal",type:"error"}),console.log("Deleting user:",e.id);const s=await this.$store.dispatch("deleteUser",e.id);console.log("Delete user response:",s),this.$message.success("User berhasil dihapus"),await this.loadUsers()}catch(s){if("cancel"!==s){console.error("Error deleting user:",s);let e="Gagal menghapus user";s.response&&s.response.data&&s.response.data.message?e=s.response.data.message:s.message&&"Invalid response format"!==s.message&&(e=s.message),this.$message.error(e)}}},async removeRole(e){try{if(!e.roles||!Array.isArray(e.roles)||0===e.roles.length)return void this.$message.warning("User ini tidak memiliki role yang dapat dihapus");const s=e.roles.filter(e=>"USER"!==e);if(0===s.length)return void this.$message.warning("User ini hanya memiliki role minimum (USER) yang tidak dapat dihapus");if(1===s.length){const t=s[0];await this.$confirm(`Apakah Anda yakin ingin menghapus role ${this.getRoleLabel(t)} dari user ${e.name}?`,"Konfirmasi Hapus Role",{confirmButtonText:"Hapus Role",cancelButtonText:"Batal",type:"warning"}),console.log(`Removing role ${t} from user: ${e.name}`);const a=await this.$store.dispatch("removeRoleFromUser",{userId:e.id,roleName:t});console.log("Role removal response:",a),this.$message.success(`Role ${this.getRoleLabel(t)} berhasil dihapus dari ${e.name}`),await this.loadUsers()}else{const{value:t}=await this.$prompt(`User ${e.name} memiliki beberapa role. Pilih role yang ingin dihapus:\n\n`+s.map((e,s)=>`${s+1}. ${this.getRoleLabel(e)}`).join("\n")+"\n\nMasukkan nomor role (1-"+s.length+"):","Pilih Role untuk Dihapus",{confirmButtonText:"Hapus Role",cancelButtonText:"Batal",inputPattern:new RegExp(`^[1-${s.length}]$`),inputErrorMessage:`Masukkan nomor antara 1-${s.length}`}),a=parseInt(t)-1,r=s[a];console.log(`Removing role ${r} from user: ${e.name}`);const o=await this.$store.dispatch("removeRoleFromUser",{userId:e.id,roleName:r});console.log("Role removal response:",o),this.$message.success(`Role ${this.getRoleLabel(r)} berhasil dihapus dari ${e.name}`),await this.loadUsers()}}catch(s){if("cancel"!==s){console.error("Error removing role:",s);let e="Gagal menghapus role user";s.response&&s.response.data&&s.response.data.message?e=s.response.data.message:s.message&&"Invalid response format"!==s.message&&(e=s.message),this.$message.error(e)}}}}},l=n,d=t(1656),u=(0,d.A)(l,a,r,!1,null,"98dd744e",null),c=u.exports}}]);
//# sourceMappingURL=manage-users.3ac4b6cf.js.map