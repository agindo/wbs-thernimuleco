"use strict";(self["webpackChunkwbs_2025"]=self["webpackChunkwbs_2025"]||[]).push([[35],{2665:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-reports"},[t("div",{staticClass:"page-header mb-6"},[t("div",{staticClass:"flex justify-between items-center"},[e._m(0),t("div",{staticClass:"flex items-center space-x-4"},[t("el-button",{attrs:{type:"success",icon:"el-icon-s-order",size:"small"},on:{click:e.openStepModalV2}},[e._v(" Buat Laporan ")]),t("el-button",{attrs:{loading:e.loading,type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.refreshReports}},[e._v(" Refresh ")])],1)])]),e.loading?t("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"text-4xl text-blue-600 mb-4 animate-spin",attrs:{icon:"mdi:loading"}}),t("p",{staticClass:"text-gray-600"},[e._v("Memuat laporan...")])],1)]):e.error?t("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"text-4xl text-red-500 mb-4",attrs:{icon:"mdi:alert-circle"}}),t("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[e._v("Gagal Memuat Data")]),t("p",{staticClass:"text-gray-600 mb-6"},[e._v(e._s(e.error))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.fetchReports}},[e._v(" Coba Lagi ")])],1)]):0!==e.displayedReports.length||e.loading?t("div",{staticClass:"space-y-4"},[t("div",{staticClass:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},[t("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"flex-shrink-0"},[t("Icon",{staticClass:"h-8 w-8 text-blue-600",attrs:{icon:"mdi:file-document-multiple"}})],1),t("div",{staticClass:"ml-3"},[t("p",{staticClass:"text-sm font-medium text-gray-500"},[e._v("Total Laporan")]),t("p",{staticClass:"text-2xl font-semibold text-gray-900"},[e.statisticsLoading?t("span",[e._v("...")]):t("span",[e._v(e._s(e.statistics.totalActiveReports||0))])])])])]),t("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"flex-shrink-0"},[t("Icon",{staticClass:"h-8 w-8 text-yellow-600",attrs:{icon:"mdi:clock-outline"}})],1),t("div",{staticClass:"ml-3"},[t("p",{staticClass:"text-sm font-medium text-gray-500"},[e._v("Pending")]),t("p",{staticClass:"text-2xl font-semibold text-gray-900"},[e._v(e._s(e.getStatusCount("pending")))])])])]),t("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"flex-shrink-0"},[t("Icon",{staticClass:"h-8 w-8 text-blue-600",attrs:{icon:"mdi:progress-check"}})],1),t("div",{staticClass:"ml-3"},[t("p",{staticClass:"text-sm font-medium text-gray-500"},[e._v("Process")]),t("p",{staticClass:"text-2xl font-semibold text-gray-900"},[e._v(e._s(e.getStatusCount("process")))])])])]),t("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"flex-shrink-0"},[t("Icon",{staticClass:"h-8 w-8 text-green-600",attrs:{icon:"mdi:check-circle"}})],1),t("div",{staticClass:"ml-3"},[t("p",{staticClass:"text-sm font-medium text-gray-500"},[e._v("Completed")]),t("p",{staticClass:"text-2xl font-semibold text-gray-900"},[e._v(e._s(e.getStatusCount("completed")))])])])])]),e._l(e.displayedReports,function(s){return t("div",{key:s.id,staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex-1 border-r pr-2"},[t("div",{staticClass:"flex items-center gap-3"},[t("h3",{staticClass:"text-lg font-semibold text-gray-900"},[e._v(e._s(e.getFieldValue(s,"name","nama","title")))]),t("span",{staticClass:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full"},[e._v(" "+e._s(e.getFieldValue(s,"code","kode")||`#${s.id}`)+" ")]),t("span",{staticClass:"px-2 py-1 text-xs font-medium rounded-full",class:e.getStatusClass(e.getFieldValue(s,"status","state"))},[e._v(" "+e._s(e.getFieldValue(s,"status","state"))+" ")])]),t("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 my-3"},[t("div",{staticClass:"space-y-1"},[t("div",{staticClass:"flex items-center text-sm text-gray-600"},[t("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:account"}}),t("p",{staticClass:"text-indigo-700 text-xs font-mono"},[e._v(e._s(s.createdBy))])],1),t("div",{staticClass:"flex items-center text-sm text-gray-600"},[t("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:map-marker"}}),t("span",[e._v(e._s(e.getFieldValue(s,"place","lokasi","location")))])],1),t("div",{staticClass:"flex items-center text-sm text-gray-600"},[t("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:tag"}}),t("span",[e._v(e._s(e.getFieldValue(s,"category","kategori","type")))])],1)]),t("div",{staticClass:"space-y-1"},[t("div",{staticClass:"flex items-center text-sm text-gray-600"},[t("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:calendar-plus"}}),t("span",[e._v("Dibuat: "+e._s(e.formatDateTime(e.getFieldValue(s,"createdAt","created_at"))))])],1),e.getFieldValue(s,"updatedAt","updated_at")!==e.getFieldValue(s,"createdAt","created_at")?t("div",{staticClass:"flex items-center text-sm text-gray-600"},[t("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:calendar-edit"}}),t("span",[e._v("Update: "+e._s(e.formatDateTime(e.getFieldValue(s,"updatedAt","updated_at"))))])],1):e._e()])]),t("div",[t("p",{staticClass:"text-sm text-gray-600 line-clamp-2"},[e._v(e._s(e.getFieldValue(s,"description","deskripsi")))])])]),t("div",{staticClass:"flex flex-col gap-1 pl-2"},[t("div",[t("el-button",{staticClass:"w-full",attrs:{type:"info",size:"mini",icon:"el-icon-view"},on:{click:function(t){return e.viewReport(s)}}},[e._v(" Detail Laporan ")])],1),t("div",[t("el-button",{staticClass:"w-full",attrs:{type:"warning",size:"mini",icon:"el-icon-edit"},on:{click:function(t){return e.editReport(s)}}},[e._v(" Perbarui Laporan ")])],1),t("div",[t("el-button",{staticClass:"w-full",attrs:{type:"success",size:"mini",icon:"el-icon-upload"},on:{click:function(t){return e.showEvidenceModal(s)}}},[e._v(" Tambah Evidence ")])],1),t("div",[t("el-button",{staticClass:"w-full",attrs:{loading:s.deleting,type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.deleteReport(s)}}},[e._v(" Hapus Laporan ")])],1)])])])}),e.totalPages>1?t("div",{staticClass:"flex justify-center mt-8"},[t("div",{staticClass:"flex items-center gap-2"},[t("el-button",{attrs:{disabled:e.pagination.first,size:"small",icon:"el-icon-arrow-left"},on:{click:function(t){return e.changePage(e.currentPage)}}}),t("span",{staticClass:"px-2 py-2 text-sm text-gray-600"},[e._v(" Halaman "+e._s(e.currentPage+1)+" dari "+e._s(e.totalPages)+" ")]),t("el-button",{attrs:{disabled:e.pagination.last,size:"small",icon:"el-icon-arrow-right"},on:{click:function(t){return e.changePage(e.currentPage+2)}}})],1),t("div",{staticClass:"my-2 mx-2 text-center text-sm text-gray-500"},[e._v(" Menampilkan "+e._s(e.pagination.totalElements)+" total laporan ")])]):e._e()],2):t("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"text-6xl text-gray-400",staticStyle:{margin:"0 auto"},attrs:{icon:"mdi:file-document-outline"}}),t("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[e._v(" "+e._s(0===e.reports.length?"Belum Ada Laporan":"Tidak Ada Laporan Ditemukan")+" ")]),t("p",{staticClass:"text-gray-600 mb-6"},[e._v(" "+e._s(0===e.reports.length?"Anda belum membuat laporan apapun":"Coba ubah kata kunci pencarian atau filter")+" ")]),t("el-button",{attrs:{type:"success",icon:"el-icon-s-order",size:"small"},on:{click:e.openStepModalV2}},[e._v(" Buat Laporan ")])],1)]),t("el-dialog",{attrs:{visible:e.showModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"60%","custom-class":"report-detail-modal",top:"20px"},on:{"update:visible":function(t){e.showModal=t},close:e.closeModal}},[t("div",{staticClass:"flex items-center",attrs:{slot:"title"},slot:"title"},[t("Icon",{staticClass:"mr-2 text-blue-600",attrs:{icon:"mdi:file-document"}}),t("span",{staticClass:"text-lg font-semibold"},[e._v("Detail Laporan")])],1),e.modalLoading?t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4",attrs:{icon:"lucide:loader-2"}}),t("p",{staticClass:"text-gray-600"},[e._v("Memuat detail laporan...")])],1):e.modalError?t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"w-12 h-12 text-red-500 mx-auto mb-4",attrs:{icon:"lucide:alert-circle"}}),t("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[e._v("Gagal Memuat Detail")]),t("p",{staticClass:"text-gray-600 mb-4"},[e._v(e._s(e.modalError))]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.fetchReportDetail(e.selectedReport?.id)}}},[e._v(" Coba Lagi ")])],1):e.selectedReport?t("div",{staticClass:"report-detail-content"},[t("div",{staticClass:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-lg mb-6"},[t("div",{staticClass:"flex items-start justify-between"},[t("div",{staticClass:"flex-1"},[t("h2",{staticClass:"text-xl font-bold mb-2"},[e._v(e._s(e.getFieldValue(e.selectedReport,"name","nama","title")))]),t("div",{staticClass:"flex items-center space-x-4 text-blue-100"},["-"!==e.getFieldValue(e.selectedReport,"code","kode")?t("div",{staticClass:"flex items-center"},[t("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:bookmark-outline"}}),t("span",{staticClass:"text-sm"},[e._v(e._s(e.getFieldValue(e.selectedReport,"code","kode")))])],1):e._e(),t("div",{staticClass:"flex items-center"},[t("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:calendar-clock"}}),t("span",{staticClass:"text-sm"},[e._v(e._s(e.formatDateTime(e.getFieldValue(e.selectedReport,"time","tanggal_waktu","datetime"))))])],1)])]),t("div",{staticClass:"text-right"},[t("span",{staticClass:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium shadow-sm",class:e.getDetailStatusClass(e.getFieldValue(e.selectedReport,"status","state"))},[t("Icon",{staticClass:"w-2 h-2 mr-2",attrs:{icon:"mdi:circle"}}),e._v(" "+e._s(e.getFieldValue(e.selectedReport,"status","state"))+" ")],1)])])]),t("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},[t("div",{staticClass:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200"},[t("div",{staticClass:"flex items-center mb-2"},[t("div",{staticClass:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:account"}})],1),t("h3",{staticClass:"font-medium text-green-800"},[e._v("Pelapor")])]),t("p",{staticClass:"text-indigo-700 ml-11 font-mono"},[e._v(e._s(e.selectedReport.createdBy))])]),t("div",{staticClass:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200"},[t("div",{staticClass:"flex items-center mb-2"},[t("div",{staticClass:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:map-marker"}})],1),t("h3",{staticClass:"font-medium text-purple-800"},[e._v("Lokasi Kejadian")])]),t("p",{staticClass:"text-purple-700 ml-11"},[e._v(e._s(e.getFieldValue(e.selectedReport,"place","lokasi","location")))])]),t("div",{staticClass:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-lg border border-yellow-200"},[t("div",{staticClass:"flex items-center mb-2"},[t("div",{staticClass:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:tag"}})],1),t("h3",{staticClass:"font-medium text-yellow-800"},[e._v("Kategori")])]),t("p",{staticClass:"text-yellow-700 ml-11 font-medium"},[e._v(e._s(e.getFieldValue(e.selectedReport,"category","kategori","type")))])]),t("div",{staticClass:"bg-gradient-to-br from-indigo-50 to-indigo-100 p-4 rounded-lg border border-indigo-200"},[t("div",{staticClass:"flex items-center mb-2"},[t("div",{staticClass:"w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:identifier"}})],1),t("h3",{staticClass:"font-medium text-indigo-800"},[e._v("ID Laporan")])]),t("p",{staticClass:"text-indigo-700 ml-11 font-mono"},[e._v(e._s(e.selectedReport.id))])])]),t("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-5 rounded-lg border border-gray-200 mb-6"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:text-box"}})],1),t("h3",{staticClass:"font-medium text-gray-800"},[e._v("Deskripsi Laporan")])]),t("div",{staticClass:"ml-11"},[t("p",{staticClass:"text-gray-700 leading-relaxed whitespace-pre-wrap"},[e._v(e._s(e.getFieldValue(e.selectedReport,"description","deskripsi","detail")))])])]),t("div",{staticClass:"grid grid-cols-1 gap-4 mb-6"},[t("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:information"}})],1),t("h3",{staticClass:"font-medium text-gray-800"},[e._v("Informasi Tambahan")])]),t("p",{staticClass:"text-gray-700 ml-11 leading-relaxed whitespace-pre-wrap"},[e._v(e._s(e.getFieldValue(e.selectedReport,"information","informasi_tambahan")))])]),t("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:package-variant"}})],1),t("h3",{staticClass:"font-medium text-gray-800"},[e._v("Barang Terkait")])]),t("p",{staticClass:"text-gray-700 ml-11"},[e._v(e._s(e.getFieldValue(e.selectedReport,"item","barang")))])]),t("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:paperclip"}})],1),t("h3",{staticClass:"font-medium text-gray-800"},[e._v("Lampiran")])]),t("p",{staticClass:"text-gray-700 ml-11"},[e._v(e._s(e.getFieldValue(e.selectedReport,"attachment","lampiran")))])])]),e.selectedReport.evidences&&e.selectedReport.evidences.length>0?t("div",{staticClass:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-lg border border-red-200 mb-6"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:paperclip"}})],1),t("h3",{staticClass:"font-medium text-red-800"},[e._v("Bukti Pendukung ("+e._s(e.selectedReport.evidences.length)+")")])]),t("div",{staticClass:"ml-11"},[t("div",{staticClass:"space-y-3"},e._l(e.selectedReport.evidences,function(s,i){return t("div",{key:s.id||i,staticClass:"evidence-item-enhanced flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors"},[t("div",{staticClass:"flex items-center space-x-3"},[t("Icon",{staticClass:"w-5 h-5 text-red-600",attrs:{icon:e.getFileIcon(s.filename||s.fileName)}}),t("div",[t("p",{staticClass:"text-sm font-medium text-red-800"},[e._v(e._s(s.filename||s.fileName||`Bukti ${i+1}`))]),s.description?t("p",{staticClass:"text-xs text-red-600"},[e._v(e._s(s.description))]):e._e()])],1),t("div",{staticClass:"evidence-actions flex items-center space-x-2"},[e.isImageFile(s.filename||s.fileName)?t("el-button",{staticClass:"text-purple-500 hover:text-purple-700",attrs:{type:"text",size:"mini",icon:"el-icon-view",title:"View image"},on:{click:function(t){return e.viewEvidenceFile(s)}}}):e._e(),t("el-button",{staticClass:"text-green-500 hover:text-green-700",attrs:{type:"text",size:"mini",icon:e.evidenceDownloading[s.id]?"el-icon-loading":"el-icon-download",loading:e.evidenceDownloading[s.id],disabled:e.evidenceDownloading[s.id],title:"Download evidence"},on:{click:function(t){return e.downloadEvidenceFile(s)}}})],1)])}),0)])]):e._e(),t("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[t("div",{staticClass:"flex items-center mb-3"},[t("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[t("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:timeline-clock"}})],1),t("h3",{staticClass:"font-medium text-gray-800"},[e._v("Timeline")])]),t("div",{staticClass:"ml-11 space-y-2"},[t("div",{staticClass:"flex items-center text-sm text-gray-700"},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:clock-outline"}}),t("span",{staticClass:"font-medium"},[e._v("Dibuat:")]),t("span",{staticClass:"ml-2"},[e._v(e._s(e.formatDateTime(e.getFieldValue(e.selectedReport,"createdAt","created_at"))))])],1),e.getFieldValue(e.selectedReport,"updatedAt","updated_at")!==e.getFieldValue(e.selectedReport,"createdAt","created_at")?t("div",{staticClass:"flex items-center text-sm text-emerald-700"},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:clock-edit-outline"}}),t("span",{staticClass:"font-medium"},[e._v("Terakhir Diupdate:")]),t("span",{staticClass:"ml-2"},[e._v(e._s(e.formatDateTime(e.getFieldValue(e.selectedReport,"updatedAt","updated_at"))))])],1):e._e()])])]):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeModal}},[e._v("Tutup")]),t("el-button",{attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(t){return e.editReport(e.selectedReport)}}},[e._v(" Edit Laporan ")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteReport(e.selectedReport)}}},[e._v(" Hapus Laporan ")])],1)]),t("el-dialog",{attrs:{visible:e.showCreateModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"50%","custom-class":"create-report-modal",top:"5vh"},on:{"update:visible":function(t){e.showCreateModal=t},close:e.closeCreateModal}},[t("div",{staticClass:"create-modal-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mr-4"},[t("Icon",{staticClass:"w-6 h-6 text-white",attrs:{icon:"mdi:file-document-plus"}})],1),t("div",[t("h3",{staticClass:"text-xl font-bold text-white"},[e._v("Buat Laporan Baru")]),t("p",{staticClass:"text-sm text-white mt-1"},[e._v("Laporkan kejadian atau pelanggaran yang Anda temui")])])])]),t("div",{staticClass:"create-modal-content"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.createReport.apply(null,arguments)}}},[t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:account"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"nama_pelapor"}},[e._v(" Nama Pelapor "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.nama_pelapor},attrs:{id:"nama_pelapor",placeholder:"Masukkan nama lengkap pelapor","prefix-icon":"el-icon-user",size:"medium",clearable:""},model:{value:e.newReport.nama_pelapor,callback:function(t){e.$set(e.newReport,"nama_pelapor",t)},expression:"newReport.nama_pelapor"}}),e.errors.nama_pelapor?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.nama_pelapor))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:calendar-clock"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"tanggal_waktu"}},[e._v(" Tanggal dan Waktu "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-date-picker",{class:{"is-error":e.errors.tanggal_waktu},staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"Pilih tanggal dan waktu kejadian",format:"dd/MM/yyyy HH:mm","value-format":"yyyy-MM-dd HH:mm:ss",size:"medium"},model:{value:e.newReport.tanggal_waktu,callback:function(t){e.$set(e.newReport,"tanggal_waktu",t)},expression:"newReport.tanggal_waktu"}}),e.errors.tanggal_waktu?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.tanggal_waktu))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:map-marker"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"lokasi"}},[e._v(" Lokasi "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.lokasi},attrs:{id:"lokasi",placeholder:"Masukkan alamat atau lokasi kejadian","prefix-icon":"el-icon-location",size:"medium",clearable:""},model:{value:e.newReport.lokasi,callback:function(t){e.$set(e.newReport,"lokasi",t)},expression:"newReport.lokasi"}}),e.errors.lokasi?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.lokasi))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:format-list-bulleted-type"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"kategori"}},[e._v(" Kategori "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-select",{class:{"is-error":e.errors.kategori},staticStyle:{width:"100%"},attrs:{placeholder:"Pilih kategori laporan",size:"medium",filterable:""},on:{change:e.onCategoryChange},model:{value:e.newReport.kategori,callback:function(t){e.$set(e.newReport,"kategori",t)},expression:"newReport.kategori"}},e._l(e.categories,function(s){return t("el-option",{key:s.value,attrs:{label:s.text,value:s.value}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(s.text))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t("Icon",{staticClass:"w-3 h-3",attrs:{icon:"mdi:tag"}})],1)])}),1),e.errors.kategori?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.kategori))]):e._e(),e.selectedCategoryDescription?t("div",{staticClass:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg"},[t("div",{staticClass:"flex items-start"},[t("Icon",{staticClass:"w-5 h-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0",attrs:{icon:"mdi:information"}}),t("div",[t("h4",{staticClass:"text-sm font-medium text-blue-800 mb-1"},[e._v("Penjelasan Kategori:")]),t("p",{staticClass:"text-sm text-blue-700"},[e._v(e._s(e.selectedCategoryDescription))])])],1)]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:file-document-edit"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"deskripsi"}},[e._v(" Deskripsi "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.deskripsi},attrs:{id:"deskripsi",type:"textarea",rows:4,placeholder:"Jelaskan secara detail apa yang terjadi, kapan, dimana, siapa yang terlibat, dan bukti yang ada...",size:"medium","show-word-limit":"",maxlength:"500"},model:{value:e.newReport.deskripsi,callback:function(t){e.$set(e.newReport,"deskripsi",t)},expression:"newReport.deskripsi"}}),e.errors.deskripsi?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.deskripsi))]):e._e()],1)])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex items-center text-sm text-gray-500"},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:shield-check"}}),t("span",[e._v("Data Anda akan terlindungi")])],1),t("div",{staticClass:"flex space-x-3"},[t("el-button",{attrs:{disabled:e.isCreatingReport,icon:"el-icon-close"},on:{click:e.closeCreateModal}},[e._v(" Batal ")]),t("el-button",{attrs:{loading:e.isCreatingReport,icon:"el-icon-plus"},on:{click:e.createReport}},[e._v(" "+e._s(e.isCreatingReport?"Membuat Laporan...":"Buat Laporan")+" ")])],1)])])]),t("el-dialog",{attrs:{visible:e.showDeleteModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"35%","custom-class":"delete-confirmation-modal",top:"20px"},on:{"update:visible":function(t){e.showDeleteModal=t},close:e.closeDeleteModal}},[t("div",{staticClass:"flex items-center",attrs:{slot:"title"},slot:"title"},[t("Icon",{staticClass:"mr-2 text-red-600",attrs:{icon:"mdi:delete-alert"}}),t("span",{staticClass:"text-lg font-semibold"},[e._v("Konfirmasi Hapus Laporan")])],1),e.reportToDelete?t("div",{staticClass:"delete-modal-content"},[t("div",{staticClass:"text-center mb-6"},[t("div",{staticClass:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[t("Icon",{staticClass:"w-8 h-8 text-red-600",attrs:{icon:"mdi:alert-circle"}})],1),t("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[e._v("Hapus Laporan Permanen")]),t("p",{staticClass:"text-sm text-gray-600"},[e._v(" Tindakan ini tidak dapat dibatalkan. Data laporan akan dihapus secara permanen dari sistem. ")])]),t("div",{staticClass:"bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-lg p-4 mb-6"},[t("div",{staticClass:"flex items-start space-x-3"},[t("div",{staticClass:"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0"},[t("Icon",{staticClass:"w-5 h-5 text-white",attrs:{icon:"mdi:file-document"}})],1),t("div",{staticClass:"flex-1 min-w-0"},[t("h4",{staticClass:"text-sm font-medium text-red-900 mb-1"},[e._v(" "+e._s(e.getFieldValue(e.reportToDelete,"name","nama","title"))+" ")]),t("div",{staticClass:"space-y-1"},["-"!==e.getFieldValue(e.reportToDelete,"code","kode")?t("div",{staticClass:"flex items-center text-xs text-red-700"},[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:bookmark-outline"}}),t("span",[e._v(e._s(e.getFieldValue(e.reportToDelete,"code","kode")))])],1):e._e(),t("div",{staticClass:"flex items-center text-xs text-red-700"},[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:account"}}),t("p",{staticClass:"text-indigo-700 text-xs font-mono"},[e._v(e._s(e.reportToDelete.createdBy))])],1),t("div",{staticClass:"flex items-center text-xs text-red-700"},[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:map-marker"}}),t("span",[e._v(e._s(e.getFieldValue(e.reportToDelete,"place","lokasi","location")))])],1)])]),t("div",{staticClass:"flex-shrink-0"},[t("span",{staticClass:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",class:e.getDetailStatusClass(e.getFieldValue(e.reportToDelete,"status","state"))},[e._v(" "+e._s(e.getFieldValue(e.reportToDelete,"status","state"))+" ")])])])]),t("div",{staticClass:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6"},[t("div",{staticClass:"flex items-start space-x-3"},[t("Icon",{staticClass:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",attrs:{icon:"mdi:information-outline"}}),t("div",{staticClass:"text-sm text-gray-700"},[t("p",{staticClass:"font-medium mb-1"},[e._v("Yang akan dihapus:")]),t("ul",{staticClass:"list-disc list-inside space-y-1 text-xs"},[t("li",[e._v("Data laporan dan semua informasinya")]),t("li",[e._v("Lampiran dan bukti pendukung")]),t("li",[e._v("Riwayat aktivitas terkait laporan")]),t("li",[e._v("Komentar dan feedback")])])])],1)]),t("div",{staticClass:"text-center"},[t("p",{staticClass:"text-sm font-medium text-gray-900 mb-2"},[e._v(" Apakah Anda yakin ingin menghapus laporan ini? ")]),t("p",{staticClass:"text-xs text-gray-600"},[e._v(' Ketik "HAPUS" di bawah untuk mengkonfirmasi penghapusan ')]),t("el-input",{staticClass:"mt-3",attrs:{placeholder:"Ketik HAPUS untuk konfirmasi",size:"small",maxlength:"5","show-word-limit":""},model:{value:e.deleteConfirmationText,callback:function(t){e.deleteConfirmationText=t},expression:"deleteConfirmationText"}})],1)]):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{disabled:e.deleteLoading},on:{click:e.closeDeleteModal}},[e._v(" Batal ")]),t("el-button",{attrs:{type:"danger",loading:e.deleteLoading,disabled:"HAPUS"!==e.deleteConfirmationText,icon:"el-icon-delete"},on:{click:e.confirmDeleteReport}},[e._v(" "+e._s(e.deleteLoading?"Menghapus...":"Ya, Hapus Laporan")+" ")])],1)]),t("el-dialog",{attrs:{visible:e.showEditModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"50%","custom-class":"create-report-modal",top:"5vh"},on:{"update:visible":function(t){e.showEditModal=t},close:e.closeEditModal}},[t("div",{staticClass:"create-modal-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mr-4"},[t("Icon",{staticClass:"w-6 h-6 text-white",attrs:{icon:"mdi:file-document-plus"}})],1),t("div",[t("h3",{staticClass:"text-xl font-bold text-white"},[e._v("Edit Laporan")]),t("p",{staticClass:"text-sm text-white mt-1"},[e._v("Edit laporkan kejadian atau pelanggaran yang Anda temui")])])])]),t("div",{staticClass:"create-modal-content"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.updateReportData.apply(null,arguments)}}},[t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:account"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"nama_pelapor"}},[e._v(" Nama Pelapor "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.nama_pelapor},attrs:{id:"nama_pelapor",placeholder:"Masukkan nama lengkap pelapor","prefix-icon":"el-icon-user",size:"medium",clearable:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}}),e.errors.nama_pelapor?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.nama_pelapor))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:calendar-clock"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"tanggal_waktu"}},[e._v(" Tanggal dan Waktu "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-date-picker",{class:{"is-error":e.errors.tanggal_waktu},staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"Pilih tanggal dan waktu kejadian",format:"dd/MM/yyyy HH:mm","value-format":"yyyy-MM-dd HH:mm:ss",size:"medium"},model:{value:e.editForm.time,callback:function(t){e.$set(e.editForm,"time",t)},expression:"editForm.time"}}),e.errors.tanggal_waktu?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.tanggal_waktu))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:map-marker"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"lokasi"}},[e._v(" Lokasi "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.lokasi},attrs:{id:"lokasi",placeholder:"Masukkan alamat atau lokasi kejadian","prefix-icon":"el-icon-location",size:"medium",clearable:""},model:{value:e.editForm.place,callback:function(t){e.$set(e.editForm,"place",t)},expression:"editForm.place"}}),e.errors.lokasi?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.lokasi))]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:format-list-bulleted-type"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"kategori"}},[e._v(" Kategori "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-select",{class:{"is-error":e.errors.kategori},staticStyle:{width:"100%"},attrs:{placeholder:"Pilih kategori laporan",size:"medium",filterable:""},on:{change:e.onCategoryUpdateChange},model:{value:e.editForm.category,callback:function(t){e.$set(e.editForm,"category",t)},expression:"editForm.category"}},e._l(e.categories,function(s){return t("el-option",{key:s.value,attrs:{label:s.text,value:s.value}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(s.text))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t("Icon",{staticClass:"w-3 h-3",attrs:{icon:"mdi:tag"}})],1)])}),1),e.errors.kategori?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.kategori))]):e._e(),e.selectedCategoryDescription?t("div",{staticClass:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg"},[t("div",{staticClass:"flex items-start"},[t("Icon",{staticClass:"w-5 h-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0",attrs:{icon:"mdi:information"}}),t("div",[t("h4",{staticClass:"text-sm font-medium text-blue-800 mb-1"},[e._v("Penjelasan Kategori:")]),t("p",{staticClass:"text-sm text-blue-700"},[e._v(e._s(e.selectedCategoryDescription))])])],1)]):e._e()],1),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-2"},[t("Icon",{staticClass:"w-4 h-4 text-blue-500 mr-2",attrs:{icon:"mdi:file-document-edit"}}),t("label",{staticClass:"text-sm font-medium text-gray-700",attrs:{for:"deskripsi"}},[e._v(" Deskripsi "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("el-input",{class:{"is-error":e.errors.deskripsi},attrs:{id:"deskripsi",type:"textarea",rows:4,placeholder:"Jelaskan secara detail apa yang terjadi, kapan, dimana, siapa yang terlibat, dan bukti yang ada...",size:"medium","show-word-limit":"",maxlength:"500"},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}}),e.errors.deskripsi?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.errors.deskripsi))]):e._e()],1)])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex items-center text-sm text-gray-500"},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:shield-check"}}),t("span",[e._v("Data Anda akan terlindungi")])],1),t("div",{staticClass:"flex space-x-3"},[t("el-button",{attrs:{disabled:e.isUpdatingReport,icon:"el-icon-close",size:"mini"},on:{click:e.closeEditModal}},[e._v(" Batal ")]),t("el-button",{attrs:{loading:e.isUpdatingReport,icon:"el-icon-edit"},on:{click:e.updateReportData}},[e._v(" "+e._s(e.isUpdatingReport?"Memperbarui Laporan...":"Perbarui Laporan")+" ")])],1)])])]),t("el-dialog",{attrs:{visible:e.evidenceModalVisible,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"50%","custom-class":"create-report-modal",top:"5vh"},on:{"update:visible":function(t){e.evidenceModalVisible=t},close:e.closeEvidenceModal}},[t("div",{staticClass:"create-modal-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"flex items-center"},[t("div",{staticClass:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center mr-4"},[t("Icon",{staticClass:"w-6 h-6 text-white",attrs:{icon:"mdi:file-upload"}})],1),t("div",[t("h3",{staticClass:"text-xl font-bold text-white"},[e._v("Upload Evidence")]),t("p",{staticClass:"text-sm text-white mt-1"},[e._v("Tambahkan bukti pendukung untuk laporan yang telah dibuat")])])])]),e.selectedReportForEvidence?t("div",{staticClass:"create-modal-content"},[t("div",{staticClass:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl"},[t("div",{staticClass:"flex items-start space-x-3"},[t("div",{staticClass:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0"},[t("Icon",{staticClass:"w-5 h-5 text-white",attrs:{icon:"mdi:file-document"}})],1),t("div",{staticClass:"flex-1 min-w-0"},[t("h4",{staticClass:"text-sm font-medium text-blue-900 mb-1"},[e._v(" "+e._s(e.getFieldValue(e.selectedReportForEvidence,"name","nama","title")||"Laporan Tanpa Nama")+" ")]),t("div",{staticClass:"space-y-1"},[t("div",{staticClass:"flex items-center text-xs text-blue-700"},[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:map-marker"}}),t("span",[e._v(e._s(e.getFieldValue(e.selectedReportForEvidence,"place","lokasi","location")))])],1)])])])]),t("div",{staticClass:"mb-6"},[t("div",{staticClass:"border-b border-gray-200"},[t("nav",{staticClass:"-mb-px flex space-x-8",attrs:{"aria-label":"Tabs"}},[t("button",{class:["upload"===e.activeEvidenceTab?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center transition-colors"],on:{click:function(t){e.activeEvidenceTab="upload"}}},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:cloud-upload"}}),e._v(" Upload Evidence ")],1),t("button",{class:["list"===e.activeEvidenceTab?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center transition-colors"],on:{click:function(t){e.activeEvidenceTab="list"}}},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:file-multiple"}}),e._v(" Evidence List "),!e.evidenceListLoading&&e.evidenceList.length>0?t("span",{staticClass:"ml-2 bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full"},[e._v(" "+e._s(e.evidenceList.length)+" ")]):e._e()],1)])])]),t("div",{staticClass:"tab-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"upload"===e.activeEvidenceTab,expression:"activeEvidenceTab === 'upload'"}],staticClass:"tab-pane"},[t("form",{on:{submit:function(t){return t.preventDefault(),e.uploadEvidence.apply(null,arguments)}}},[t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-3"},[t("Icon",{staticClass:"w-5 h-5 text-green-500 mr-2",attrs:{icon:"mdi:attachment"}}),t("label",{staticClass:"text-sm font-semibold text-gray-800"},[e._v(" File Evidence "),t("span",{staticClass:"text-red-500"},[e._v("*")])])],1),t("div",{staticClass:"upload-area-wrapper"},[t("div",{staticClass:"custom-file-upload",class:{dragover:e.isDragOver},on:{click:e.triggerFileInput,dragover:function(t){return t.preventDefault(),e.handleDragOver.apply(null,arguments)},dragleave:function(t){return t.preventDefault(),e.handleDragLeave.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.handleFileDrop.apply(null,arguments)}}},[t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*,.pdf,.doc,.docx"},on:{change:e.handleFileInputChange}}),t("div",{staticClass:"upload-content"},[t("div",{staticClass:"upload-icon-container"},[t("Icon",{staticClass:"w-12 h-12 text-green-500",attrs:{icon:"mdi:cloud-upload"}})],1),t("div",{staticClass:"upload-text-content"},[t("p",{staticClass:"upload-primary-text"},[e.evidenceForm.file?t("span",{staticClass:"text-green-600 font-semibold"},[e._v("✓ "+e._s(e.evidenceForm.file.name))]):t("span",[e._v("Klik untuk pilih file atau drag & drop")])]),t("p",{staticClass:"upload-secondary-text"},[e._v("Format yang didukung: JPG, PNG, PDF, DOC, DOCX")]),t("p",{staticClass:"upload-size-text"},[e._v("Maksimal ukuran file: 10MB")])])])]),e.evidenceForm.file?t("div",{staticClass:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex items-center"},[t("Icon",{staticClass:"w-5 h-5 text-green-500 mr-2",attrs:{icon:"mdi:file-check"}}),t("div",[t("p",{staticClass:"text-sm font-medium text-green-800"},[e._v(e._s(e.evidenceForm.file.name))]),t("p",{staticClass:"text-xs text-green-600"},[e._v(e._s(e.formatFileSize(e.evidenceForm.file.size)))])])],1),t("button",{staticClass:"text-red-500 hover:text-red-700 transition-colors",attrs:{type:"button"},on:{click:e.removeFile}},[t("Icon",{staticClass:"w-5 h-5",attrs:{icon:"mdi:close-circle"}})],1)])]):e._e(),e.evidenceErrors.file?t("div",{staticClass:"mt-2 text-red-500 text-sm flex items-center"},[t("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:alert-circle"}}),e._v(" "+e._s(e.evidenceErrors.file)+" ")],1):e._e()])]),t("div",{staticClass:"form-group"},[t("div",{staticClass:"flex items-center mb-3"},[t("Icon",{staticClass:"w-5 h-5 text-green-500 mr-2",attrs:{icon:"mdi:text-long"}}),t("label",{staticClass:"text-sm font-semibold text-gray-800"},[e._v(" Deskripsi Evidence "),t("span",{staticClass:"text-gray-500"},[e._v("(opsional)")])])],1),t("el-input",{staticClass:"evidence-textarea",attrs:{type:"textarea",rows:4,placeholder:"Jelaskan detail tentang file evidence yang diupload...",maxlength:300,"show-word-limit":""},model:{value:e.evidenceForm.description,callback:function(t){e.$set(e.evidenceForm,"description",t)},expression:"evidenceForm.description"}})],1)])]),e.evidenceUploadError?t("div",{staticClass:"mt-6 p-4 bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-lg"},[t("div",{staticClass:"flex items-start"},[t("Icon",{staticClass:"w-5 h-5 text-red-500 mt-0.5 mr-2 flex-shrink-0",attrs:{icon:"mdi:alert-circle"}}),t("div",{staticClass:"text-sm text-red-700"},[t("p",{staticClass:"font-medium"},[e._v("Gagal mengupload evidence:")]),t("p",[e._v(e._s(e.evidenceUploadError))])])],1)]):e._e()]),t("div",{directives:[{name:"show",rawName:"v-show",value:"list"===e.activeEvidenceTab,expression:"activeEvidenceTab === 'list'"}],staticClass:"tab-pane"},[t("div",{staticClass:"evidence-list-section"},[e.evidenceListLoading?t("div",{staticClass:"text-center py-12"},[t("Icon",{staticClass:"w-8 h-8 animate-spin text-green-600 mx-auto mb-3",attrs:{icon:"mdi:loading"}}),t("p",{staticClass:"text-gray-600"},[e._v("Memuat daftar evidence...")])],1):e.evidenceListError?t("div",{staticClass:"p-6 bg-red-50 border border-red-200 rounded-lg"},[t("div",{staticClass:"flex items-center"},[t("Icon",{staticClass:"w-5 h-5 text-red-500 mr-2",attrs:{icon:"mdi:alert-circle"}}),t("div",[t("p",{staticClass:"text-sm font-medium text-red-800"},[e._v("Gagal memuat daftar evidence")]),t("p",{staticClass:"text-sm text-red-600"},[e._v(e._s(e.evidenceListError))])])],1),t("el-button",{staticClass:"mt-4",attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:function(t){return e.fetchEvidenceList(e.selectedReportForEvidence.id)}}},[e._v(" Coba Lagi ")])],1):0===e.evidenceList.length?t("div",{staticClass:"text-center py-12 bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg"},[t("Icon",{staticClass:"w-16 h-16 text-gray-400 mx-auto mb-4",attrs:{icon:"mdi:file-outline"}}),t("h4",{staticClass:"text-lg font-medium text-gray-600 mb-2"},[e._v("Belum ada evidence")]),t("p",{staticClass:"text-sm text-gray-500 mb-6"},[e._v("Upload file evidence pertama untuk laporan ini")]),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"},on:{click:function(t){e.activeEvidenceTab="upload"}}},[e._v(" Upload Evidence ")])],1):t("div",{staticClass:"space-y-4 max-h-96 overflow-y-auto evidence-scroll"},[t("div",{staticClass:"mb-4 flex items-center justify-between"},[t("h4",{staticClass:"text-lg font-semibold text-gray-800"},[e._v(" Evidence yang Sudah Diupload ")]),t("span",{staticClass:"bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full"},[e._v(" "+e._s(e.evidenceList.length)+" file ")])]),e._l(e.evidenceList,function(s){return t("div",{key:s.id,staticClass:"p-4 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow"},[t("div",{staticClass:"flex items-start justify-between"},[t("div",{staticClass:"flex items-start space-x-3 flex-1"},[t("div",{staticClass:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0"},[t("Icon",{staticClass:"w-6 h-6 text-green-600",attrs:{icon:e.getFileIcon(s.filename||s.fileName)}})],1),t("div",{staticClass:"flex-1 min-w-0"},[t("h5",{staticClass:"text-sm font-medium text-gray-900 truncate"},[e._v(" "+e._s(s.filename||s.fileName||"Unknown File")+" ")]),s.description?t("p",{staticClass:"text-xs text-gray-600 mt-1 line-clamp-2"},[e._v(" "+e._s(s.description)+" ")]):e._e(),t("div",{staticClass:"flex items-center space-x-4 mt-2 text-xs text-gray-500"},[s.fileSize?t("span",[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:file-outline"}}),e._v(" "+e._s(e.formatFileSize(s.fileSize))+" ")],1):e._e(),s.uploadedAt||s.createdAt?t("span",[t("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:calendar-clock"}}),e._v(" "+e._s(e.formatDateTime(s.uploadedAt||s.createdAt))+" ")],1):e._e()])])]),t("div",{staticClass:"flex items-center space-x-2 ml-3"},[e.isImageFile(s.filename||s.fileName)?t("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-view",circle:"",title:"View Image"},on:{click:function(t){return e.viewEvidenceFile(s)}}}):e._e(),t("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-download",circle:"",title:"Download Evidence"},on:{click:function(t){return e.downloadEvidenceFile(s)}}}),t("el-button",{attrs:{loading:e.evidenceDeleting[s.id],disabled:e.evidenceDeleting[s.id],type:"danger",size:"mini",icon:"el-icon-delete",circle:"",title:"Hapus Evidence"},on:{click:function(t){return e.deleteEvidenceFile(s)}}})],1)])])})],2)])])])]):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex items-center text-sm text-gray-500"},[t("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:shield-check"}}),"upload"===e.activeEvidenceTab?t("span",[e._v("File akan disimpan dengan aman")]):t("span",[e._v(e._s(e.evidenceList.length)+" evidence tersimpan")])],1),t("div",{staticClass:"flex space-x-3"},[t("el-button",{attrs:{disabled:e.evidenceUploading,icon:"el-icon-close"},on:{click:e.closeEvidenceModal}},[e._v(" Tutup ")]),"upload"===e.activeEvidenceTab?t("el-button",{attrs:{loading:e.evidenceUploading,type:"primary",icon:"el-icon-upload",disabled:!e.evidenceForm.file},on:{click:e.uploadEvidence}},[e._v(" "+e._s(e.evidenceUploading?"Mengupload...":"Upload Evidence")+" ")]):t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.activeEvidenceTab="upload"}}},[e._v(" Tambah Evidence ")])],1)])])]),t("el-dialog",{attrs:{visible:e.showStepModalV2,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"50%","custom-class":"step-modal-v2",top:"5vh"},on:{"update:visible":function(t){e.showStepModalV2=t},close:e.closeStepModalV2}},[t("div",{attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex items-center"},[t("Icon",{staticClass:"w-6 h-6 mr-3 text-green-600",attrs:{icon:"mdi:clipboard-text"}}),t("div",[t("h3",{staticClass:"text-lg font-semibold text-gray-800"},[e._v("Buat Laporan Baru - Versi 2")]),t("p",{staticClass:"text-sm text-gray-600"},[e._v(" "+e._s(1===e.currentStepV2?"Step 1: Informasi Pelaporan":"Step 2: Upload Evidence")+" ")])])],1),t("div",{staticClass:"flex items-center space-x-2"},[t("div",{staticClass:"flex items-center"},[t("div",{class:["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2",e.currentStepV2>=1?"bg-green-500 text-white border-green-500":"bg-gray-200 text-gray-400 border-gray-300"]},[e._v(" 1 ")]),t("div",{staticClass:"w-12 h-1 mx-1",class:e.currentStepV2>=2?"bg-green-500":"bg-gray-300"}),t("div",{class:["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2",e.currentStepV2>=2?"bg-green-500 text-white border-green-500":"bg-gray-200 text-gray-400 border-gray-300"]},[e._v(" 2 ")])]),t("span",{staticClass:"text-sm text-gray-500 ml-3"},[e._v(e._s(e.currentStepV2)+"/2")])])])]),1===e.currentStepV2?t("div",{staticClass:"px-6 pb-6"},[t("div",{staticClass:"space-y-5"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v(" Nama Pelapor "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("el-input",{attrs:{placeholder:"Masukkan nama pelapor",maxlength:100,"show-word-limit":"",clearable:"","prefix-icon":"el-icon-user"},model:{value:e.stepFormV2.reporterName,callback:function(t){e.$set(e.stepFormV2,"reporterName",t)},expression:"stepFormV2.reporterName"}}),e.stepErrorsV2.reporterName?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.stepErrorsV2.reporterName))]):e._e()],1),t("div",{staticClass:"form-group"},[t("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v(" Tanggal dan Waktu "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"Pilih tanggal dan waktu kejadian",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.stepFormV2.time,callback:function(t){e.$set(e.stepFormV2,"time",t)},expression:"stepFormV2.time"}}),e.stepErrorsV2.time?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.stepErrorsV2.time))]):e._e()],1),t("div",{staticClass:"form-group"},[t("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v(" Lokasi "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("el-input",{attrs:{placeholder:"Masukkan lokasi kejadian",maxlength:200,"show-word-limit":"",clearable:"","prefix-icon":"el-icon-location"},model:{value:e.stepFormV2.place,callback:function(t){e.$set(e.stepFormV2,"place",t)},expression:"stepFormV2.place"}}),e.stepErrorsV2.place?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.stepErrorsV2.place))]):e._e()],1),t("div",{staticClass:"form-group"},[t("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v(" Kategori "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Pilih kategori pelanggaran",clearable:""},model:{value:e.stepFormV2.category,callback:function(t){e.$set(e.stepFormV2,"category",t)},expression:"stepFormV2.category"}},e._l(e.categories,function(e){return t("el-option",{key:e.value,attrs:{label:e.text,value:e.value,disabled:"belum pilih"===e.value}})}),1),e.stepErrorsV2.category?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.stepErrorsV2.category))]):e._e()],1),t("div",{staticClass:"form-group"},[t("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[e._v(" Deskripsi "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"Jelaskan detail pelanggaran yang terjadi...",maxlength:1e3,"show-word-limit":""},model:{value:e.stepFormV2.description,callback:function(t){e.$set(e.stepFormV2,"description",t)},expression:"stepFormV2.description"}}),e.stepErrorsV2.description?t("p",{staticClass:"mt-1 text-sm text-red-600"},[e._v(e._s(e.stepErrorsV2.description))]):e._e()],1),e.stepErrorV2?t("div",{staticClass:"bg-red-50 border border-red-200 rounded-lg p-4"},[t("div",{staticClass:"flex items-start"},[t("Icon",{staticClass:"w-5 h-5 text-red-500 mt-0.5 mr-3 flex-shrink-0",attrs:{icon:"mdi:alert-circle"}}),t("div",{staticClass:"text-sm"},[t("p",{staticClass:"font-medium text-red-800"},[e._v("Gagal membuat laporan")]),t("p",{staticClass:"text-red-700 mt-1"},[e._v(e._s(e.stepErrorV2))])])],1)]):e._e()])]):e._e(),2===e.currentStepV2?t("div",{staticClass:"px-6 pb-6"},[t("div",{staticClass:"mb-6"},[t("div",{staticClass:"flex items-center mb-4"},[t("Icon",{staticClass:"w-6 h-6 text-green-500 mr-2",attrs:{icon:"mdi:check-circle"}}),t("span",{staticClass:"text-green-700 font-medium"},[e._v("Laporan berhasil dibuat!")])],1),t("p",{staticClass:"text-gray-600 text-sm"},[e._v(" Sekarang Anda dapat menambahkan bukti pendukung untuk memperkuat laporan (opsional). ")])]),t("div",{class:["border-2 border-dashed rounded-lg p-6 text-center transition-all duration-300",e.isDragOver?"border-green-400 bg-green-50":"border-gray-300 hover:border-green-400 hover:bg-gray-50"],on:{drop:e.handleDropV2,dragover:function(e){e.preventDefault()},dragenter:function(t){e.isDragOver=!0},dragleave:function(t){e.isDragOver=!1}}},[t("Icon",{staticClass:"w-12 h-12 text-gray-400 mx-auto mb-3",attrs:{icon:"mdi:cloud-upload"}}),t("div",{staticClass:"space-y-1"},[t("p",{staticClass:"text-base font-medium text-gray-700"},[e._v(" Drag & drop files di sini atau "),t("label",{staticClass:"text-green-600 hover:text-green-500 cursor-pointer font-medium underline"},[e._v(" pilih files "),t("input",{staticClass:"hidden",attrs:{type:"file",multiple:"",accept:"image/*,.pdf,.doc,.docx,.txt"},on:{change:e.handleFileSelectV2}})])]),t("p",{staticClass:"text-xs text-gray-500"},[e._v(" Mendukung: Gambar, PDF, DOC, DOCX, TXT (Maksimal 10MB per file) ")])])],1),e.stepEvidenceFilesV2.length>0?t("div",{staticClass:"mt-6"},[t("h4",{staticClass:"text-base font-medium text-gray-800 mb-3"},[e._v(" Files Terpilih ("+e._s(e.stepEvidenceFilesV2.length)+") ")]),t("div",{staticClass:"space-y-3 max-h-60 overflow-y-auto"},e._l(e.stepEvidenceFilesV2,function(s,i){return t("div",{key:i,staticClass:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors"},[t("div",{staticClass:"flex items-center space-x-3"},[t("i",{staticClass:"text-blue-500 text-lg",class:e.getFileIconClass(s.name)}),t("div",[t("p",{staticClass:"text-sm font-medium text-gray-800"},[e._v(e._s(s.name))]),t("p",{staticClass:"text-xs text-gray-500"},[e._v(e._s(e.formatFileSize(s.size)))])])]),t("div",{staticClass:"flex items-center space-x-2"},[t("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"Deskripsi (opsional)",size:"mini",maxlength:100},model:{value:s.description,callback:function(t){e.$set(s,"description",t)},expression:"file.description"}}),void 0!==e.stepEvidenceProgressV2[i]?t("div",{staticClass:"w-16"},[t("el-progress",{attrs:{percentage:e.stepEvidenceProgressV2[i],"show-text":!1,"stroke-width":3,status:"success"}})],1):e._e(),t("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:"",disabled:e.stepEvidenceUploadingV2},on:{click:function(t){return e.removeFileV2(i)}}})],1)])}),0)]):e._e(),e.createdReportIdV2&&e.evidenceList.length>0?t("div",{staticClass:"mt-6"},[t("h4",{staticClass:"text-base font-medium text-gray-800 mb-3"},[e._v(" Evidence yang Sudah Di-upload ("+e._s(e.evidenceList.length)+") ")]),t("div",{staticClass:"space-y-2 max-h-40 overflow-y-auto"},e._l(e.evidenceList,function(s){return t("div",{key:s.id,staticClass:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors"},[t("div",{staticClass:"flex items-center space-x-3"},[t("Icon",{staticClass:"w-5 h-5 text-green-500",attrs:{icon:"mdi:check-circle"}}),t("div",[t("p",{staticClass:"text-sm font-medium text-gray-800"},[e._v(e._s(s.filename||s.fileName))]),t("p",{staticClass:"text-xs text-gray-500"},[e._v(e._s(s.description||"No description"))])])],1),t("div",{staticClass:"flex items-center space-x-2"},[e.isImageFile(s.filename||s.fileName)?t("el-button",{staticClass:"text-purple-500 hover:text-purple-700",attrs:{type:"text",size:"mini",icon:"el-icon-view",title:"View image"},on:{click:function(t){return e.viewEvidenceFile(s)}}}):e._e(),t("el-button",{staticClass:"text-blue-500 hover:text-blue-700",attrs:{type:"text",size:"mini",icon:e.evidenceDownloading[s.id]?"el-icon-loading":"el-icon-download",loading:e.evidenceDownloading[s.id],disabled:e.evidenceDownloading[s.id],title:"Download evidence"},on:{click:function(t){return e.downloadEvidenceFile(s)}}}),t("el-button",{staticClass:"text-red-500 hover:text-red-700",attrs:{type:"text",size:"mini",icon:e.evidenceDeleting[s.id]?"el-icon-loading":"el-icon-delete",loading:e.evidenceDeleting[s.id],disabled:e.evidenceDeleting[s.id],title:"Delete evidence"},on:{click:function(t){return e.deleteEvidenceFileV2(s)}}})],1)])}),0)]):e._e()]):e._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"text-sm text-gray-500"},[t("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:information"}}),e._v(" "+e._s(1===e.currentStepV2?"Lengkapi informasi laporan":"Upload evidence (opsional)")+" ")],1),t("div",{staticClass:"flex space-x-3"},[1===e.currentStepV2?[t("el-button",{attrs:{disabled:e.stepLoadingV2},on:{click:e.closeStepModalV2}},[e._v(" Batal ")]),t("el-button",{attrs:{loading:e.stepLoadingV2,type:"primary",icon:"el-icon-arrow-right"},on:{click:e.proceedToStep2V2}},[e._v(" "+e._s(e.stepLoadingV2?"Membuat Laporan...":"Lanjut ke Evidence")+" ")])]:e._e(),2===e.currentStepV2?[t("el-button",{attrs:{disabled:e.stepEvidenceUploadingV2},on:{click:function(t){e.currentStepV2=1}}},[t("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:arrow-left"}}),e._v(" Kembali ")],1),t("el-button",{attrs:{disabled:e.stepEvidenceUploadingV2,type:"info"},on:{click:e.skipEvidenceV2}},[e._v(" Lewati Evidence ")]),e.stepEvidenceFilesV2.length>0?t("el-button",{attrs:{loading:e.stepEvidenceUploadingV2,type:"warning",icon:"el-icon-upload2"},on:{click:e.uploadAllEvidenceV2}},[e._v(" "+e._s(e.stepEvidenceUploadingV2?"Mengupload...":`Upload ${e.stepEvidenceFilesV2.length} Files`)+" ")]):e._e(),t("el-button",{attrs:{disabled:e.stepEvidenceUploadingV2,type:"success",icon:"el-icon-check"},on:{click:e.finishReportV2}},[e._v(" Selesai ")])]:e._e()],2)])])]),t("EvidenceViewer",{attrs:{visible:e.showEvidenceViewer,"evidence-data":e.selectedEvidenceForView},on:{"update:visible":function(t){e.showEvidenceViewer=t},close:e.handleEvidenceViewerClose}})],1)},a=[function(){var e=this,t=e._self._c;return t("div",[t("h1",{staticClass:"text-2xl font-bold text-gray-900"},[e._v("Laporan Saya")]),t("p",{staticClass:"text-gray-600"},[e._v("Kelola dan pantau status laporan yang Anda buat")])])}],r=(s(4114),s(8111),s(2489),s(116),s(7588),s(4603),s(7566),s(8721),s(8298)),l=s(2399),o=s(1835),n=s(7215),c=s(6050),d={name:"MyReports",components:{Icon:r.In,EvidenceViewer:c.A},data(){return{reports:[],loading:!1,error:null,searchQuery:"",selectedCategory:"",currentPage:0,itemsPerPage:10,pagination:{totalElements:0,totalPages:0,first:!0,last:!0,empty:!1},showModal:!1,selectedReport:null,modalLoading:!1,modalError:null,showCreateModal:!1,isCreatingReport:!1,createLoading:!1,createError:null,showDeleteModal:!1,reportToDelete:null,deleteLoading:!1,deleteConfirmationText:"",evidenceModalVisible:!1,selectedReportForEvidence:null,evidenceUploading:!1,isDragOver:!1,evidenceUploadError:null,evidenceFileList:[],evidenceForm:{file:null,description:"",reportId:null},evidenceErrors:{file:"",description:""},evidenceList:[],evidenceListLoading:!1,evidenceDeleting:{},evidenceDownloading:{},evidenceListError:null,activeEvidenceTab:"upload",showEvidenceViewer:!1,selectedEvidenceForView:{},showStepModalV2:!1,currentStepV2:1,stepFormV2:{reporterName:"",time:"",place:"",category:"belum pilih",description:""},stepErrorsV2:{reporterName:"",time:"",place:"",category:"",description:""},stepLoadingV2:!1,stepErrorV2:null,createdReportIdV2:null,stepEvidenceFilesV2:[],stepEvidenceUploadingV2:!1,stepEvidenceProgressV2:{},showEditModal:!1,editingReport:null,isUpdatingReport:!1,updateError:null,editForm:{name:"",time:"",place:"",category:"belum pilih",description:"",information:"",item:"",status:"Process"},statusOptions:[{value:"Process",text:"Process"},{value:"Completed",text:"Completed"},{value:"Cancelled",text:"Cancelled"},{value:"Pending",text:"Pending"}],newReport:{nama_pelapor:"",tanggal_waktu:"",lokasi:"",kategori:"belum pilih",deskripsi:""},categories:[{value:"belum pilih",text:"Pilih Kategori Penyalahgunaan"},{value:"Suap",text:"Suap"},{value:"Korupsi",text:"Korupsi"},{value:"Penipuan",text:"Penipuan"},{value:"Kode Etik",text:"Kode Etik"},{value:"Penggelapan",text:"Penggelapan"},{value:"Kecurangan",text:"Kecurangan"},{value:"Pencurian",text:"Pencurian"},{value:"Gratifikasi",text:"Gratifikasi"},{value:"Pemerasan",text:"Pemerasan"},{value:"Benturan Kepentingan",text:"Benturan Kepentingan"}],errors:{},selectedCategoryDescription:"",statistics:{totalActiveReports:0},statisticsLoading:!1}},computed:{filteredReports(){let e=this.reports;if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.code.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.place.toLowerCase().includes(t))}return this.selectedCategory&&(e=e.filter(e=>e.category===this.selectedCategory)),e=e.filter(e=>e.isActived&&!e.isDeleted),e},totalPages(){return this.pagination.totalPages},displayedReports(){return this.searchQuery||this.selectedCategory?this.filteredReports:this.reports}},async mounted(){await this.fetchReports(),this.fetchStatistics(),document.addEventListener("keydown",this.handleKeydown)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeydown)},methods:{async fetchReports(){this.loading=!0,this.error=null;try{const e=await l.A.getMyReports(this.currentPage,this.itemsPerPage);console.log("Full API result:",e),this.reports=e.content||[],this.pagination=e.pagination||{totalElements:0,totalPages:0,first:!0,last:!0,empty:!1},console.log("Reports loaded:",this.reports.length),console.log("Sample report structure:",this.reports[0]),console.log("Pagination info:",this.pagination)}catch(e){console.error("Error fetching reports:",e),this.error=e.message,this.reports=[],this.pagination={totalElements:0,totalPages:0,first:!0,last:!0,empty:!1}}finally{this.loading=!1}},async fetchStatistics(){this.statisticsLoading=!0;try{console.log("Fetching reports statistics...");const e=await l.A.getReportsStatistics();console.log("Statistics result:",e),e&&e.success&&e.data?(this.statistics=e.data,console.log("Statistics loaded successfully:",this.statistics)):console.warn("Invalid statistics response:",e)}catch(e){console.error("Error fetching statistics:",e)}finally{this.statisticsLoading=!1}},async refreshReports(){await this.fetchReports(),this.fetchStatistics()},formatDateTime(e){if(!e)return"Tidak diketahui";try{const t=new Date(e);return t.toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}},getStatusClass(e){const t={Dibatalkan:"bg-red-100 text-red-800",Dikirim:"bg-blue-100 text-blue-800",Disaring:"bg-yellow-100 text-yellow-800","Investigasi Awal":"bg-orange-100 text-orange-800",Dilaporkan:"bg-purple-100 text-purple-800","Investigasi Lanjutan":"bg-indigo-100 text-indigo-800","Buat Tim":"bg-teal-100 text-teal-800","Buat Laporan":"bg-cyan-100 text-cyan-800","Keputusan Terakhir":"bg-green-100 text-green-800"};return t[e]||"bg-gray-100 text-gray-800"},getStatusText(e){switch(e?.toLowerCase()){case"pending":case"menunggu":return"Menunggu";case"approved":case"disetujui":return"Disetujui";case"rejected":case"ditolak":return"Ditolak";case"in progress":case"sedang diproses":return"Sedang Diproses";case"completed":case"selesai":return"Selesai";default:return e||"Status Tidak Diketahui"}},viewReport(e){console.log("View report clicked:",e),this.showModal=!0;const t=e.id;if(!t)return console.error("Report ID is missing:",e),void(this.modalError="ID laporan tidak valid");this.fetchReportDetail(t)},async fetchReportDetail(e){if(e){this.modalLoading=!0,this.modalError=null,this.selectedReport=null;try{console.log("Fetching report detail for ID:",e);const t=await l.A.getReport(e);console.log("Report detail result:",t),console.log("Report detail structure:",t.report),t&&t.report?(this.selectedReport=t.report,console.log("Selected report set to:",this.selectedReport),console.log("Available fields in selectedReport:",Object.keys(t.report))):this.modalError="Data laporan tidak ditemukan"}catch(t){console.error("Error fetching report detail:",t),this.modalError=t.message||"Gagal memuat detail laporan"}finally{this.modalLoading=!1}}else this.modalError="ID laporan tidak valid"},closeModal(){this.showModal=!1,this.selectedReport=null,this.modalError=null,this.modalLoading=!1},handleKeydown(e){"Escape"===e.key&&(this.showModal||this.showCreateModal||this.showDeleteModal||this.showEditModal)&&(this.showDeleteModal?this.closeDeleteModal():this.showEditModal?this.closeEditModal():this.showModal?this.closeModal():this.showCreateModal&&this.closeCreateModal())},openCreateModal(){this.showCreateModal=!0,this.resetCreateForm()},closeCreateModal(){this.showCreateModal=!1,this.createError=null,this.createLoading=!1,this.resetCreateForm()},resetCreateForm(){this.newReport={nama_pelapor:"",tanggal_waktu:"",lokasi:"",kategori:"belum pilih",deskripsi:""},this.errors={},this.selectedCategoryDescription=""},async createReport(){if(this.errors={},this.validateCreateForm()){this.isCreatingReport=!0;try{const e={name:this.newReport.nama_pelapor,time:this.newReport.tanggal_waktu,place:this.newReport.lokasi,category:this.newReport.kategori,description:this.newReport.deskripsi,status:"Open"},t=await l.A.createReport(e);t.success&&(this.closeCreateModal(),this.resetCreateForm(),await this.fetchReports(),this.$toast&&this.$toast.success?this.$toast.success(t.message||"Laporan berhasil dibuat"):alert(t.message||"Laporan berhasil dibuat"))}catch(e){console.error("Error creating report:",e),e.errors&&"object"===typeof e.errors?this.errors=e.errors:this.$toast&&this.$toast.error?this.$toast.error(e.message||"Gagal membuat laporan"):alert(e.message||"Gagal membuat laporan")}finally{this.isCreatingReport=!1}}},validateCreateForm(){this.errors={};let e=!0;return this.newReport.nama_pelapor.trim()||(this.errors.nama_pelapor="Nama pelapor wajib diisi",e=!1),this.newReport.tanggal_waktu||(this.errors.tanggal_waktu="Tanggal dan waktu wajib diisi",e=!1),this.newReport.lokasi.trim()||(this.errors.lokasi="Lokasi wajib diisi",e=!1),this.newReport.kategori&&"belum pilih"!==this.newReport.kategori||(this.errors.kategori="Kategori wajib dipilih",e=!1),this.newReport.deskripsi.trim()||(this.errors.deskripsi="Deskripsi wajib diisi",e=!1),e},getFieldValue(e,...t){for(const s of t)if(e&&void 0!==e[s]&&null!==e[s]&&""!==e[s]&&"Tidak ada"!==e[s])return e[s];return"-"},getStatusCount(e){const t=e.toLowerCase();return this.reports.filter(e=>{const s=this.getFieldValue(e,"status","state").toLowerCase();return s===t}).length},getDetailStatusClass(e){const t={Dibatalkan:"bg-red-500 text-white",Dikirim:"bg-blue-500 text-white",Disaring:"bg-yellow-500 text-white","Investigasi Awal":"bg-orange-500 text-white",Dilaporkan:"bg-purple-500 text-white","Investigasi Lanjutan":"bg-indigo-500 text-white","Buat Tim":"bg-teal-500 text-white","Buat Laporan":"bg-cyan-500 text-white","Keputusan Terakhir":"bg-green-500 text-white"};return t[e]||"bg-gray-500 text-white"},onCategoryChange(){if(this.newReport.kategori&&"belum pilih"!==this.newReport.kategori){const e=n.v.find(e=>e.title===this.newReport.kategori);this.selectedCategoryDescription=e?e.description:""}else this.selectedCategoryDescription=""},onCategoryUpdateChange(){if(this.editForm.category&&"belum pilih"!==this.editForm.category){const e=n.v.find(e=>e.title===this.editForm.category);this.selectedCategoryDescription=e?e.description:""}else this.selectedCategoryDescription=""},deleteReport(e){this.reportToDelete=e,this.showDeleteModal=!0,this.deleteConfirmationText=""},closeDeleteModal(){this.showDeleteModal=!1,this.reportToDelete=null,this.deleteLoading=!1,this.deleteConfirmationText=""},async confirmDeleteReport(){if("HAPUS"===this.deleteConfirmationText){this.deleteLoading=!0;try{await l.A.deleteReport(this.reportToDelete.id),this.$message.success({message:`Laporan "${this.getFieldValue(this.reportToDelete,"name","nama","title")}" berhasil dihapus`,duration:3e3,showClose:!0}),this.closeDeleteModal(),this.selectedReport&&this.selectedReport.id===this.reportToDelete.id&&this.closeModal(),await this.fetchReports()}catch(e){console.error("Error deleting report:",e),this.$message.error({message:`Gagal menghapus laporan: ${e.message}`,duration:5e3,showClose:!0})}finally{this.deleteLoading=!1}}else this.$message.warning('Silakan ketik "HAPUS" untuk mengkonfirmasi penghapusan')},showEvidenceModal(e){console.log("showEvidenceModal called with report:",e),this.selectedReportForEvidence=e,this.evidenceModalVisible=!0,this.evidenceForm.reportId=e.id,this.activeEvidenceTab="upload",this.resetEvidenceForm(),this.fetchEvidenceList(e.id),console.log("evidenceModalVisible set to:",this.evidenceModalVisible)},closeEvidenceModal(){this.evidenceModalVisible=!1,this.selectedReportForEvidence=null,this.evidenceUploading=!1,this.evidenceUploadError=null,this.evidenceList=[],this.evidenceListLoading=!1,this.evidenceListError=null,this.activeEvidenceTab="upload",this.resetEvidenceForm()},resetEvidenceForm(){this.evidenceForm={file:null,description:"",reportId:this.evidenceForm.reportId||null},this.evidenceFileList=[],this.evidenceErrors={file:"",description:""}},handleFileChange(e){const t=10485760;if(e.size>t)return this.evidenceErrors.file="Ukuran file maksimal 10MB",void(this.evidenceFileList=[]);const s=["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];if(!s.includes(e.raw.type))return this.evidenceErrors.file="Format file tidak didukung. Gunakan JPG, PNG, PDF, DOC, atau DOCX",void(this.evidenceFileList=[]);this.evidenceForm.file=e.raw,this.evidenceFileList=[e],this.evidenceErrors.file=""},triggerFileInput(){this.$refs.fileInput.click()},handleFileInputChange(e){const t=e.target.files[0];t&&this.processFile(t)},handleFileDrop(e){this.isDragOver=!1;const t=e.dataTransfer.files;t.length>0&&this.processFile(t[0])},handleDragOver(e){this.isDragOver=!0},handleDragLeave(e){this.isDragOver=!1},processFile(e){const t=10485760;if(e.size>t)return void(this.evidenceErrors.file="Ukuran file maksimal 10MB");const s=["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];s.includes(e.type)?(this.evidenceForm.file=e,this.evidenceErrors.file=""):this.evidenceErrors.file="Format file tidak didukung. Gunakan JPG, PNG, PDF, DOC, atau DOCX"},removeFile(){this.evidenceForm.file=null,this.$refs.fileInput.value="",this.evidenceErrors.file=""},formatFileSize(e){if(0===e)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,i)).toFixed(2))+" "+s[i]},async fetchEvidencesByReportId(e){try{const t=await o.A.getEvidencesByReportId(e);return t.success?t.data:(console.error("Failed to fetch evidences:",t.error),[])}catch(t){return console.error("Error fetching evidences:",t),[]}},async fetchEvidenceList(e){if(e){this.evidenceListLoading=!0,this.evidenceListError=null;try{const t=await o.A.getEvidenceListByReportId(e);t.success?(this.evidenceList=t.data.data||[],console.log("Evidence list loaded:",this.evidenceList.length,"items")):(this.evidenceListError=t.error||"Failed to load evidence list",this.evidenceList=[])}catch(t){console.error("Error fetching evidence list:",t),this.evidenceListError=t.message||"Error loading evidence list",this.evidenceList=[]}finally{this.evidenceListLoading=!1}}else console.error("Report ID is required to fetch evidence list")},async deleteEvidence(e){try{const t=await o.A.deleteEvidence(e);return t.success?(this.$message.success("Evidence berhasil dihapus"),await this.fetchReports(),!0):(this.$message.error(t.error||"Gagal menghapus evidence"),!1)}catch(t){return console.error("Error deleting evidence:",t),this.$message.error("Terjadi kesalahan saat menghapus evidence"),!1}},async downloadEvidence(e,t){try{const s=await o.A.downloadEvidence(e);if(s.success){const e=new Blob([s.data]),i=window.URL.createObjectURL(e),a=document.createElement("a");a.href=i,a.download=t||"evidence-file",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(i),document.body.removeChild(a),this.$message.success("Evidence berhasil didownload")}else this.$message.error(s.error||"Gagal mendownload evidence")}catch(s){console.error("Error downloading evidence:",s),this.$message.error("Terjadi kesalahan saat mendownload evidence")}},validateEvidenceForm(){return this.evidenceErrors={file:"",description:""},!!this.evidenceForm.file||(this.evidenceErrors.file="Silakan pilih file evidence",!1)},async uploadEvidence(){if(this.validateEvidenceForm()){this.evidenceUploading=!0,this.evidenceUploadError=null;try{console.log("Uploading evidence:",{file:this.evidenceForm.file.name,description:this.evidenceForm.description,reportId:this.evidenceForm.reportId});const e=await o.A.uploadEvidence(this.evidenceForm.file,this.evidenceForm.description.trim(),this.evidenceForm.reportId);if(!e.success)throw new Error(e.error||"Upload failed");this.$message.success({message:"Evidence berhasil diupload",duration:3e3,showClose:!0}),this.closeEvidenceModal(),await this.fetchReports(),await this.fetchEvidenceList(this.evidenceForm.reportId)}catch(e){console.error("Error uploading evidence:",e),this.evidenceUploadError=e.message||"Gagal mengupload evidence"}finally{this.evidenceUploading=!1}}},getFileIcon(e){if(!e)return"mdi:file-outline";const t=e.toLowerCase().split(".").pop();switch(t){case"pdf":return"mdi:file-pdf-box";case"doc":case"docx":return"mdi:file-word-box";case"jpg":case"jpeg":case"png":case"gif":return"mdi:file-image-box";default:return"mdi:file-outline"}},async downloadEvidenceFile(e){this.$set(this.evidenceDownloading,e.id,!0);try{console.log("Downloading evidence:",e);const t=await o.A.downloadEvidence(e.id,e.filename||e.fileName);t.success?this.showNotificationV2("success","Download Berhasil",`Evidence "${e.filename||e.fileName}" berhasil didownload`):this.$message.error(t.error||"Gagal mendownload evidence")}catch(t){console.error("Error downloading evidence:",t),this.$message.error("Terjadi kesalahan saat mendownload evidence")}finally{this.$delete(this.evidenceDownloading,e.id)}},async deleteEvidenceFile(e){try{const t=await this.$confirm(`Apakah Anda yakin ingin menghapus evidence "${e.filename||e.fileName}"?`,"Konfirmasi Hapus Evidence",{confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",type:"warning",confirmButtonClass:"el-button--danger"});if(t){this.$set(this.evidenceDeleting,e.id,!0);try{const t=await o.A.deleteEvidence(e.id);t.success?(this.$message.success("Evidence berhasil dihapus"),await this.fetchEvidenceList(this.selectedReportForEvidence.id),await this.fetchReports()):this.$message.error(t.error||"Gagal menghapus evidence")}finally{this.$delete(this.evidenceDeleting,e.id)}}}catch(t){"cancel"!==t&&(console.error("Error deleting evidence:",t),this.$message.error("Terjadi kesalahan saat menghapus evidence")),this.$delete(this.evidenceDeleting,e.id)}},editReport(e){this.editingReport=e,this.prepareEditForm(e),this.showEditModal=!0},prepareEditForm(e){this.editForm={name:this.getFieldValue(e,"name","nama","nama_pelapor","title")||"",time:this.getFieldValue(e,"time","tanggal_waktu","datetime","created_at")||"",place:this.getFieldValue(e,"place","lokasi","location","tempat")||"",category:this.getFieldValue(e,"category","kategori","type")||"belum pilih",description:this.getFieldValue(e,"description","deskripsi","detail","content")||"",information:this.getFieldValue(e,"information","informasi_tambahan","additional_info")||"",item:this.getFieldValue(e,"item","barang","item_terkait")||"",status:this.getFieldValue(e,"status","state","condition")||"Process"},this.updateError=null},closeEditModal(){this.showEditModal=!1,this.editingReport=null,this.updateError=null,this.isUpdatingReport=!1,this.editForm={name:"",time:"",place:"",category:"belum pilih",description:"",information:"",item:"",status:"Dikirim"}},async updateReportData(){if(this.editingReport&&this.editingReport.id)if(this.editForm.name.trim())if(this.editForm.time)if(this.editForm.place.trim())if(this.editForm.category&&"belum pilih"!==this.editForm.category)if(this.editForm.description.trim()){this.isUpdatingReport=!0,this.updateError=null;try{const e={name:this.editForm.name.trim(),time:this.editForm.time,place:this.editForm.place.trim(),category:this.editForm.category,description:this.editForm.description.trim(),information:this.editForm.information.trim()||null,item:this.editForm.item.trim()||null,status:this.editForm.status};console.log("Updating report with data:",e);const t=await l.A.updateReport(this.editingReport.id,e);t.success&&(this.closeEditModal(),this.selectedReport&&this.selectedReport.id===this.editingReport.id&&this.closeModal(),await this.fetchReports(),this.$toast?.success?.(t.message||"Laporan berhasil diupdate")||alert(t.message||"Laporan berhasil diupdate"))}catch(e){console.error("Error updating report:",e),this.updateError=e.message||"Gagal mengupdate laporan"}finally{this.isUpdatingReport=!1}}else this.updateError="Deskripsi harus diisi";else this.updateError="Kategori harus dipilih";else this.updateError="Lokasi kejadian harus diisi";else this.updateError="Waktu kejadian harus diisi";else this.updateError="Nama laporan harus diisi";else this.updateError="Data laporan tidak valid"},changePage(e){const t=e-1;t>=0&&t<this.totalPages&&(this.currentPage=t,this.fetchReports())},openStepModalV2(){this.showStepModalV2=!0,this.currentStepV2=1,this.resetStepFormV2(),this.stepErrorV2=null,this.createdReportIdV2=null,this.stepEvidenceFilesV2=[],this.stepEvidenceProgressV2={},this.$nextTick(()=>{document.addEventListener("keydown",this.handleStepModalKeydown)})},closeStepModalV2(){this.showStepModalV2=!1,this.currentStepV2=1,this.resetStepFormV2(),this.stepErrorV2=null,this.createdReportIdV2=null,this.stepEvidenceFilesV2=[],this.stepEvidenceProgressV2={},document.removeEventListener("keydown",this.handleStepModalKeydown)},resetStepFormV2(){this.stepFormV2={reporterName:"",time:"",place:"",category:"belum pilih",description:""},this.stepErrorsV2={reporterName:"",time:"",place:"",category:"",description:""}},validateStepFormV2(){let e=!0;return this.stepErrorsV2={reporterName:"",time:"",place:"",category:"",description:""},this.stepFormV2.reporterName?.trim()||(this.stepErrorsV2.reporterName="Nama pelapor wajib diisi",e=!1),this.stepFormV2.time||(this.stepErrorsV2.time="Tanggal dan waktu wajib diisi",e=!1),this.stepFormV2.place?.trim()||(this.stepErrorsV2.place="Lokasi kejadian wajib diisi",e=!1),this.stepFormV2.category&&"belum pilih"!==this.stepFormV2.category||(this.stepErrorsV2.category="Kategori wajib dipilih",e=!1),this.stepFormV2.description?.trim()||(this.stepErrorsV2.description="Deskripsi wajib diisi",e=!1),e},async proceedToStep2V2(){if(this.validateStepFormV2()){this.stepLoadingV2=!0,this.stepErrorV2=null;try{const e={name:this.stepFormV2.reporterName.trim(),time:this.stepFormV2.time,place:this.stepFormV2.place.trim(),category:this.stepFormV2.category,description:this.stepFormV2.description.trim(),status:"Dikirim",information:`Dilaporkan oleh: ${this.stepFormV2.reporterName.trim()}`},t=await l.A.createReport(e);console.log(t),t.success?(this.createdReportIdV2=t.report.id,this.currentStepV2=2,this.showNotificationV2("success","Laporan Dibuat","Laporan berhasil dibuat! Silakan tambahkan evidence jika ada."),console.log("Report created with ID:",this.createdReportIdV2),this.createdReportIdV2&&await this.fetchEvidenceListV2(this.createdReportIdV2)):this.stepErrorV2=t.error||"Gagal membuat laporan"}catch(e){console.error("Error creating report:",e),this.stepErrorV2="Terjadi kesalahan saat membuat laporan"}finally{this.stepLoadingV2=!1}}else this.$message.warning("Mohon lengkapi semua field yang wajib diisi")},handleFileSelectV2(e){const t=Array.from(e.target.files);this.addFilesV2(t),e.target.value=""},handleDropV2(e){e.preventDefault(),this.isDragOver=!1;const t=Array.from(e.dataTransfer.files);this.addFilesV2(t)},addFilesV2(e){e.forEach(e=>{if(!this.validateFile(e))return;const t=this.stepEvidenceFilesV2.find(t=>t.name===e.name&&t.size===e.size);t?this.$message.warning(`File ${e.name} sudah dipilih.`):(e.description="",this.stepEvidenceFilesV2.push(e))})},removeFileV2(e){this.stepEvidenceFilesV2.splice(e,1),this.$delete(this.stepEvidenceProgressV2,e)},formatFileSizeV2(e){if(0===e)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,i)).toFixed(2))+" "+s[i]},async uploadAllEvidenceV2(){if(0===this.stepEvidenceFilesV2.length)return void this.$message.warning("Tidak ada file untuk diupload");if(!this.createdReportIdV2)return void this.$message.error("ID laporan tidak ditemukan. Silakan buat laporan terlebih dahulu.");this.stepEvidenceUploadingV2=!0;let e=0,t=0;try{for(let i=0;i<this.stepEvidenceFilesV2.length;i++){const a=this.stepEvidenceFilesV2[i];try{this.$set(this.stepEvidenceProgressV2,i,0);const s=await o.A.uploadEvidence(a,a.description||`Evidence untuk laporan oleh ${this.stepFormV2.reporterName}`,this.createdReportIdV2);s.success?(this.$set(this.stepEvidenceProgressV2,i,100),e++):(t++,this.$message.error(`Gagal upload ${a.name}: ${s.error}`))}catch(s){t++,console.error(`Error uploading ${a.name}:`,s),this.$message.error(`Error upload ${a.name}`)}}e>0&&this.showNotificationV2("success","Upload Berhasil",`Berhasil upload ${e} file evidence`),t>0&&this.showNotificationV2("warning","Upload Sebagian Gagal",`${t} file gagal diupload`),await this.fetchEvidenceListV2(this.createdReportIdV2)}finally{this.stepEvidenceUploadingV2=!1}},async fetchEvidenceListV2(e){try{const t=await o.A.getEvidenceListByReportId(e);t.success&&(this.evidenceList=t.data||[])}catch(t){console.error("Error fetching evidence list:",t)}},async deleteEvidenceFileV2(e){try{const s=await this.$confirm(`Apakah Anda yakin ingin menghapus evidence "${e.filename||e.fileName}"?`,"Konfirmasi Hapus Evidence",{confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",type:"warning",confirmButtonClass:"el-button--danger"});if(s){this.$set(this.evidenceDeleting,e.id,!0);try{const t=await o.A.deleteEvidence(e.id);t.success?(this.showNotificationV2("success","Evidence Dihapus","Evidence berhasil dihapus"),this.createdReportIdV2&&await this.fetchEvidenceListV2(this.createdReportIdV2)):this.$message.error(t.error||"Gagal menghapus evidence")}catch(t){console.error("Error deleting evidence:",t),this.$message.error("Terjadi kesalahan saat menghapus evidence")}finally{this.$delete(this.evidenceDeleting,e.id)}}}catch(s){"cancel"!==s&&(console.error("Error in deleteEvidenceFileV2:",s),this.$message.error("Terjadi kesalahan saat menghapus evidence"))}},skipEvidenceV2(){this.finishReportV2()},async finishReportV2(){await this.fetchReports(),this.$message.success("Laporan berhasil dibuat!"),this.closeStepModalV2()},formatFileSize(e){if(0===e)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,i)).toFixed(2))+" "+s[i]},getFileIconClass(e){if(!e)return"el-icon-document";const t=e.split(".").pop().toLowerCase(),s={pdf:"el-icon-document",doc:"el-icon-document",docx:"el-icon-document",jpg:"el-icon-picture",jpeg:"el-icon-picture",png:"el-icon-picture",gif:"el-icon-picture",mp4:"el-icon-video-camera",avi:"el-icon-video-camera",zip:"el-icon-folder-opened",rar:"el-icon-folder-opened",default:"el-icon-document"};return s[t]||s.default},showNotificationV2(e,t,s){this.$notify({title:t,message:s,type:e,duration:3e3,position:"top-right"})},validateFile(e){const t=10485760,s=["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","video/mp4","video/avi","application/zip","application/x-rar-compressed"];return e.size>t?(this.$message.error(`File ${e.name} terlalu besar. Maksimal 10MB.`),!1):!!s.includes(e.type)||(this.$message.error(`Tipe file ${e.name} tidak didukung.`),!1)},viewEvidenceFile(e){this.selectedEvidenceForView=e,this.showEvidenceViewer=!0},handleEvidenceViewerClose(){this.showEvidenceViewer=!1,this.selectedEvidenceForView={}},isImageFile(e){if(!e)return!1;const t=[".jpg",".jpeg",".png",".gif",".bmp",".webp"];return t.some(t=>e.toLowerCase().endsWith(t))},handleStepModalKeydown(e){this.showStepModalV2&&("Escape"!==e.key?("Enter"!==e.key||e.shiftKey||"TEXTAREA"===e.target.tagName||(e.preventDefault(),1===this.currentStepV2?this.proceedToStep2V2():2===this.currentStepV2&&this.stepEvidenceFilesV2.length>0&&this.uploadAllEvidenceV2()),"Tab"!==e.key||this.currentStepV2):this.closeStepModalV2())}},watch:{searchQuery(){},selectedCategory(){}}},p=d,m=s(1656),u=(0,m.A)(p,i,a,!1,null,"44f772c8",null),g=u.exports}}]);
//# sourceMappingURL=my-reports.f81f6163.js.map