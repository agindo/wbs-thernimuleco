"use strict";(self["webpackChunkwbs_2025"]=self["webpackChunkwbs_2025"]||[]).push([[920],{1835:function(e,t,a){a(4603),a(7566),a(8721);var s=a(417);const r="https://wbsreborn.lan.go.id/sylow",o=()=>localStorage.getItem("token")||sessionStorage.getItem("token"),n=()=>{const e=o(),t={"Content-Type":"multipart/form-data"};return e&&(t["Authorization"]=`Bearer ${e}`),t};class i{async uploadEvidence(e,t,a){try{const i=o();if(!i)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const c=new FormData;c.append("file",e),c.append("description",t),c.append("reportId",a);const d={...n()},l=await s.A.post(`${r}/evidences/upload`,c,{headers:d,timeout:3e4,onUploadProgress:e=>{const t=Math.round(100*e.loaded/e.total);console.log(`Upload Progress: ${t}%`)}});return{success:!0,data:l.data,message:"Evidence uploaded successfully"}}catch(i){return console.error("Error uploading evidence:",i),i.response?{success:!1,error:i.response.data?.message||"Failed to upload evidence",status:i.response.status,data:i.response.data}:i.request?{success:!1,error:"Network error. Please check your connection.",status:null}:{success:!1,error:i.message||"Unexpected error occurred",status:null}}}async getEvidencesByReportId(e){try{const t=o();if(!t)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const a=await s.A.get(`${r}/evidences/report/${e}`,{headers:n(),timeout:1e4});return{success:!0,data:a.data,message:"Evidences retrieved successfully"}}catch(t){return console.error("Error fetching evidences:",t),{success:!1,error:t.response?.data?.message||"Failed to fetch evidences",status:t.response?.status}}}async getEvidenceListByReportId(e){try{const t=o();if(!t)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const a=await s.A.get(`${r}/evidences/report/${e}/list`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:1e4});return{success:!0,data:a.data,message:"Evidence list retrieved successfully"}}catch(t){return console.error("Error fetching evidence list:",t),{success:!1,error:t.response?.data?.message||"Failed to fetch evidence list",status:t.response?.status}}}async deleteEvidence(e){try{const t=o();if(!t)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const a=await s.A.delete(`${r}/evidences/${e}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:1e4});return{success:!0,data:a.data,message:"Evidence deleted successfully"}}catch(t){return console.error("Error deleting evidence:",t),{success:!1,error:t.response?.data?.message||"Failed to delete evidence",status:t.response?.status}}}async viewEvidence(e){try{const t=o();if(!t)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const a=await s.A.get(`${r}/evidences/${e}/view`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},responseType:"blob",timeout:3e4}),n=window.URL.createObjectURL(new Blob([a.data]));return{success:!0,data:n,headers:a.headers,message:"Evidence view URL generated successfully"}}catch(t){return console.error("Error viewing evidence:",t),{success:!1,error:t.response?.data?.message||"Failed to view evidence",status:t.response?.status}}}async downloadEvidence(e,t){try{const a=o();if(!a)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const n=await s.A.get(`${r}/evidences/${e}/download`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},responseType:"blob",timeout:3e4}),i=window.URL.createObjectURL(new Blob([n.data])),c=document.createElement("a");return c.href=i,c.setAttribute("download",t||"evidence-file"),document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(i),{success:!0,data:n.data,headers:n.headers,message:"Evidence downloaded successfully"}}catch(a){return console.error("Error downloading evidence:",a),{success:!1,error:a.response?.data?.message||"Failed to download evidence",status:a.response?.status}}}async getAllEvidences(e=0,t=10,a="createdAt",n="desc"){try{const i=o();if(!i)return{success:!1,error:"Authentication token not found. Please login again.",status:401};const c=await s.A.get(`${r}/evidences`,{params:{page:e,size:t,sortBy:a,sortDir:n},headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},timeout:1e4});return{success:!0,data:c.data,message:"All evidences retrieved successfully"}}catch(i){return console.error("Error fetching all evidences:",i),{success:!1,error:i.response?.data?.message||"Failed to fetch evidences",status:i.response?.status}}}}t.A=new i},2399:function(e,t,a){a.d(t,{A:function(){return i}});var s=a(417);const r=s.A.create({baseURL:"https://wbsreborn.lan.go.id/sylow/api",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{const t=localStorage.getItem("token")||sessionStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),sessionStorage.removeItem("token")),Promise.reject(e)));var o=r;class n{async updateReport(e,t){try{const a=await o.put(`/reports/${e}`,t);if(a.data.success)return{success:!0,report:a.data.data,message:a.data.message||"Report updated successfully"};throw new Error(a.data.message||"Failed to update report")}catch(a){throw this.handleError(a)}}async getMyReports(e=0,t=10){try{const a=await o.get("/reports/my",{params:{page:e,size:t}});if(a.data.success)return{content:a.data.data.content,pagination:{page:a.data.data.page,size:a.data.data.size,totalElements:a.data.data.totalElements,totalPages:a.data.data.totalPages,first:a.data.data.first,last:a.data.data.last,empty:a.data.data.empty},message:a.data.message};throw new Error(a.data.message||"Failed to fetch reports")}catch(a){throw this.handleError(a)}}async getAllReports(e=0,t=10,a="createdAt",s="desc"){try{const r=await o.get("/reports",{params:{page:e,size:t,sortBy:a,sortDir:s}});if(r.data.success)return{content:r.data.data.content,pagination:{page:r.data.data.page,size:r.data.data.size,totalElements:r.data.data.totalElements,totalPages:r.data.data.totalPages,first:r.data.data.first,last:r.data.data.last,empty:r.data.data.empty},message:r.data.message};throw new Error(r.data.message||"Failed to fetch all reports")}catch(r){throw this.handleError(r)}}async getReport(e){try{const t=await o.get(`/reports/${e}`);if(t.data.success)return{report:t.data.data,message:t.data.message};throw new Error(t.data.message||"Failed to fetch report")}catch(t){throw this.handleError(t)}}async createReport(e){try{const t=await o.post("/reports",e);if(t.data.success)return{success:!0,report:t.data.data,message:t.data.message||"Report created successfully"};throw new Error(t.data.message||"Failed to create report")}catch(t){throw this.handleError(t)}}async updateReport(e,t){try{const a=await o.put(`/reports/${e}`,t);return a.data}catch(a){throw this.handleError(a)}}async deleteReport(e){try{const t=await o.delete(`/reports/${e}`);if(t.data.success)return{success:!0,message:t.data.message||"Report deleted successfully"};throw new Error(t.data.message||"Failed to delete report")}catch(t){throw this.handleError(t)}}async uploadAttachment(e,t){try{const a=new FormData;a.append("attachment",t);const s=await o.post(`/reports/${e}/attachment`,a,{headers:{"Content-Type":"multipart/form-data"}});return s.data}catch(a){throw this.handleError(a)}}async addEvidence(e,t){try{const a=await o.post(`/reports/${e}/evidence`,t);return a.data}catch(a){throw this.handleError(a)}}async getReportsStatistics(){try{const e=await o.get("/reports/statistics");return e.data}catch(e){throw this.handleError(e)}}async searchReports(e,t={}){try{const a={q:e,...t},s=await o.get("/reports/search",{params:a});return s.data}catch(a){throw this.handleError(a)}}async updateReportStatus(e,t,a="Tidak ada"){try{const s=await o.patch(`/reports/${e}/status`,{status:t,reason:a});return s.data}catch(s){throw this.handleError(s)}}handleError(e){if(e.response){const t=e.response.data?.message||`Server error: ${e.response.status}`;return new Error(t)}return e.request?new Error("Tidak dapat terhubung ke server. Pastikan server berjalan di http://localhost:8080"):new Error(`Error: ${e.message}`)}}var i=new n},6050:function(e,t,a){a.d(t,{A:function(){return l}});var s=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.title,width:"80%",top:"5vh","custom-class":"evidence-viewer-modal","close-on-click-modal":!0,"close-on-press-escape":!0},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[t("div",{staticClass:"evidence-viewer-content"},[e.loading?t("div",{staticClass:"text-center py-8"},[t("i",{staticClass:"el-icon-loading text-4xl text-gray-400 mb-4"}),t("p",{staticClass:"text-gray-600"},[e._v("Memuat evidence...")])]):e.error?t("div",{staticClass:"text-center py-8"},[t("i",{staticClass:"el-icon-warning text-4xl text-red-400 mb-4"}),t("p",{staticClass:"text-red-600 mb-4"},[e._v(e._s(e.error))]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.retry}},[t("i",{staticClass:"el-icon-refresh mr-1"}),e._v(" Coba Lagi ")])],1):e.imageUrl&&e.isImage?t("div",{staticClass:"image-container"},[t("div",{staticClass:"image-wrapper"},[t("img",{staticClass:"evidence-image",attrs:{src:e.imageUrl,alt:e.evidenceData.filename||e.evidenceData.fileName},on:{load:e.handleImageLoad,error:e.handleImageError}})]),t("div",{staticClass:"image-controls"},[t("el-button-group",[t("el-button",{attrs:{size:"small",icon:"el-icon-zoom-in",title:"Zoom In"},on:{click:e.zoomIn}}),t("el-button",{attrs:{size:"small",icon:"el-icon-zoom-out",title:"Zoom Out"},on:{click:e.zoomOut}}),t("el-button",{attrs:{size:"small",icon:"el-icon-refresh",title:"Reset Zoom"},on:{click:e.resetZoom}}),t("el-button",{attrs:{size:"small",icon:"el-icon-download",title:"Download"},on:{click:e.downloadEvidence}})],1)],1)]):t("div",{staticClass:"file-info-container"},[t("div",{staticClass:"file-info"},[t("div",{staticClass:"file-icon"},[t("i",{staticClass:"text-6xl text-gray-400",class:e.getFileIcon(e.evidenceData.filename||e.evidenceData.fileName)})]),t("div",{staticClass:"file-details"},[t("h3",{staticClass:"file-name"},[e._v(e._s(e.evidenceData.filename||e.evidenceData.fileName||"Unknown File"))]),e.evidenceData.description?t("p",{staticClass:"file-description"},[e._v(e._s(e.evidenceData.description))]):e._e(),t("div",{staticClass:"file-meta"},[e.evidenceData.fileSize?t("span",{staticClass:"meta-item"},[t("i",{staticClass:"el-icon-document mr-1"}),e._v(" "+e._s(e.formatFileSize(e.evidenceData.fileSize))+" ")]):e._e(),e.evidenceData.uploadedAt||e.evidenceData.createdAt?t("span",{staticClass:"meta-item"},[t("i",{staticClass:"el-icon-time mr-1"}),e._v(" "+e._s(e.formatDateTime(e.evidenceData.uploadedAt||e.evidenceData.createdAt))+" ")]):e._e()])])]),t("div",{staticClass:"file-actions"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downloadEvidence}},[e._v(" Download File ")])],1)])]),e.loading||e.error?e._e():t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"evidence-info"},[t("span",{staticClass:"evidence-filename"},[e._v(e._s(e.evidenceData.filename||e.evidenceData.fileName||"Unknown File"))]),e.evidenceData.description?t("span",{staticClass:"evidence-description"},[e._v(e._s(e.evidenceData.description))]):e._e()]),t("el-button",{on:{click:e.handleClose}},[e._v("Tutup")])],1)])},r=[],o=(a(4603),a(7566),a(8721),a(1835)),n={name:"EvidenceViewer",props:{visible:{type:Boolean,default:!1},evidenceData:{type:Object,default:()=>({})}},data(){return{loading:!1,error:null,imageUrl:null,zoomLevel:1}},computed:{title(){return`View Evidence: ${this.evidenceData.filename||this.evidenceData.fileName||"Unknown File"}`},isImage(){const e=this.evidenceData.filename||this.evidenceData.fileName||"",t=[".jpg",".jpeg",".png",".gif",".bmp",".webp"];return t.some(t=>e.toLowerCase().endsWith(t))}},watch:{visible(e){e&&this.evidenceData.id?this.loadEvidence():e||this.cleanup()},evidenceData:{handler(e){this.visible&&e.id&&this.loadEvidence()},deep:!0}},methods:{async loadEvidence(){if(this.evidenceData.id){if(this.isImage){this.loading=!0,this.error=null;try{const e=await o.A.viewEvidence(this.evidenceData.id);e.success?this.imageUrl=e.data:this.error=e.error||"Gagal memuat evidence"}catch(e){console.error("Error loading evidence:",e),this.error="Terjadi kesalahan saat memuat evidence"}finally{this.loading=!1}}}else this.error="Evidence ID tidak ditemukan"},async downloadEvidence(){try{const e=await o.A.downloadEvidence(this.evidenceData.id,this.evidenceData.filename||this.evidenceData.fileName);e.success?this.$message.success("Evidence berhasil didownload"):this.$message.error(e.error||"Gagal mendownload evidence")}catch(e){console.error("Error downloading evidence:",e),this.$message.error("Terjadi kesalahan saat mendownload evidence")}},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleImageLoad(){console.log("Image loaded successfully")},handleImageError(){this.error="Gagal memuat gambar. File mungkin rusak atau tidak tersedia."},retry(){this.loadEvidence()},zoomIn(){this.zoomLevel=Math.min(this.zoomLevel+.25,3),this.applyZoom()},zoomOut(){this.zoomLevel=Math.max(this.zoomLevel-.25,.25),this.applyZoom()},resetZoom(){this.zoomLevel=1,this.applyZoom()},applyZoom(){const e=this.$el.querySelector(".evidence-image");e&&(e.style.transform=`scale(${this.zoomLevel})`)},cleanup(){this.imageUrl&&(window.URL.revokeObjectURL(this.imageUrl),this.imageUrl=null),this.error=null,this.loading=!1,this.zoomLevel=1},getFileIcon(e){if(!e)return"el-icon-document";const t=e.split(".").pop().toLowerCase(),a={pdf:"el-icon-document",doc:"el-icon-document",docx:"el-icon-document",txt:"el-icon-document",jpg:"el-icon-picture",jpeg:"el-icon-picture",png:"el-icon-picture",gif:"el-icon-picture",bmp:"el-icon-picture",webp:"el-icon-picture",mp4:"el-icon-video-camera",avi:"el-icon-video-camera",zip:"el-icon-folder-opened",rar:"el-icon-folder-opened",default:"el-icon-document"};return a[t]||a.default},formatFileSize(e){if(!e||0===e)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,s)).toFixed(2))+" "+a[s]},formatDateTime(e){if(!e)return"-";try{const t=new Date(e);return t.toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}},beforeDestroy(){this.cleanup()}},i=n,c=a(1656),d=(0,c.A)(i,s,r,!1,null,"a0ed3fe2",null),l=d.exports}}]);
//# sourceMappingURL=920.c2b03e9a.js.map