"use strict";(self["webpackChunkwbs_2025"]=self["webpackChunkwbs_2025"]||[]).push([[94],{9724:function(t,e,r){r.r(e),r.d(e,{default:function(){return p}});r(8111),r(1701);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"create-report"},[t._m(0),e("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[e("form",{staticClass:"space-y-6",on:{submit:function(e){return e.preventDefault(),t.submitReport.apply(null,arguments)}}},[e("div",[t._m(1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.name,expression:"reportForm.name"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",id:"name",placeholder:"Masukkan nama laporan",required:""},domProps:{value:t.reportForm.name},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"name",e.target.value)}}})]),e("div",[t._m(2),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.time,expression:"reportForm.time"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{type:"datetime-local",id:"time",required:""},domProps:{value:t.reportForm.time},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"time",e.target.value)}}})]),e("div",[t._m(3),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.place,expression:"reportForm.place"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",id:"place",placeholder:"Masukkan lokasi kejadian",required:""},domProps:{value:t.reportForm.place},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"place",e.target.value)}}})]),e("div",[t._m(4),e("select",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.category,expression:"reportForm.category"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{id:"category",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(t.reportForm,"category",e.target.multiple?r:r[0])}}},[e("option",{attrs:{value:""}},[t._v("Pilih kategori")]),e("option",{attrs:{value:"Security"}},[t._v("Security")]),e("option",{attrs:{value:"Financial"}},[t._v("Financial")]),e("option",{attrs:{value:"Operational"}},[t._v("Operational")]),e("option",{attrs:{value:"HR"}},[t._v("Human Resources")]),e("option",{attrs:{value:"Compliance"}},[t._v("Compliance")]),e("option",{attrs:{value:"IT"}},[t._v("Information Technology")]),e("option",{attrs:{value:"Other"}},[t._v("Lainnya")])])]),e("div",[t._m(5),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.description,expression:"reportForm.description"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{id:"description",rows:"4",placeholder:"Jelaskan detail kejadian yang dilaporkan",required:""},domProps:{value:t.reportForm.description},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"description",e.target.value)}}})]),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"information"}},[t._v(" Informasi Tambahan ")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.information,expression:"reportForm.information"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{id:"information",rows:"3",placeholder:"Informasi tambahan atau detail yang relevan"},domProps:{value:t.reportForm.information},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"information",e.target.value)}}})]),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"item"}},[t._v(" Item/Barang Bukti ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.item,expression:"reportForm.item"}],staticClass:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",attrs:{type:"text",id:"item",placeholder:"Sebutkan barang bukti yang terkait"},domProps:{value:t.reportForm.item},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"item",e.target.value)}}})]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reportForm.status,expression:"reportForm.status"}],attrs:{type:"hidden"},domProps:{value:t.reportForm.status},on:{input:function(e){e.target.composing||t.$set(t.reportForm,"status",e.target.value)}}}),e("div",{staticClass:"flex justify-end space-x-4"},[e("button",{staticClass:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",attrs:{type:"button"},on:{click:t.resetForm}},[t._v(" Reset ")]),e("button",{staticClass:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",attrs:{type:"submit",disabled:t.isSubmitting}},[t.isSubmitting?e("Icon",{staticClass:"animate-spin mr-2",attrs:{icon:"mdi:loading"}}):t._e(),t._v(" "+t._s(t.isSubmitting?"Mengirim...":"Kirim Laporan")+" ")],1)])])])])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-header mb-6"},[e("h1",{staticClass:"text-2xl font-bold text-gray-900"},[t._v("Buat Laporan Baru")]),e("p",{staticClass:"text-gray-600"},[t._v("Laporkan dugaan pelanggaran dengan aman dan terjamin")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"name"}},[t._v(" Nama Laporan "),e("span",{staticClass:"text-red-500"},[t._v("*")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"time"}},[t._v(" Waktu Kejadian "),e("span",{staticClass:"text-red-500"},[t._v("*")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"place"}},[t._v(" Tempat Kejadian "),e("span",{staticClass:"text-red-500"},[t._v("*")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"category"}},[t._v(" Kategori "),e("span",{staticClass:"text-red-500"},[t._v("*")])])},function(){var t=this,e=t._self._c;return e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2",attrs:{for:"description"}},[t._v(" Deskripsi Kejadian "),e("span",{staticClass:"text-red-500"},[t._v("*")])])}],s=(r(4114),r(8298)),i=r(417),n={name:"CreateReport",components:{Icon:s.In},data(){return{isSubmitting:!1,reportForm:{name:"",time:"",place:"",category:"",description:"",information:"",item:"",status:"Open"}}},mounted(){this.setCurrentDateTime()},methods:{setCurrentDateTime(){const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");this.reportForm.time=`${e}-${r}-${a}T${o}:${s}`},formatTimeForAPI(t){const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),n=String(e.getSeconds()).padStart(2,"0");return`${r}-${a}-${o} ${s}:${i}:${n}`},async submitReport(){try{this.isSubmitting=!0;const t=localStorage.getItem("token");if(!t)return this.$message.error("Sesi telah berakhir. Silakan login ulang"),void this.$router.push("/login");const e={name:this.reportForm.name,time:this.formatTimeForAPI(this.reportForm.time),place:this.reportForm.place,category:this.reportForm.category,description:this.reportForm.description,information:this.reportForm.information||"",item:this.reportForm.item||"",status:this.reportForm.status};console.log("Submitting report:",e);const r=await i.A.post("http://localhost:8080/api/reports",e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});console.log("Report submission response:",r),this.$message.success("Laporan berhasil dikirim!"),this.resetForm()}catch(t){console.error("Error submitting report:",t);let e="Gagal mengirim laporan";if(t.response){const r=t.response.status;401===r?(e="Sesi telah berakhir. Silakan login ulang",this.$router.push("/login")):e=403===r?"Akses ditolak untuk mengirim laporan":400===r?t.response.data?.message||"Data laporan tidak valid":422===r?"Data laporan tidak lengkap atau format salah":t.response.data?.message||`Server error: ${r}`}else e=t.request?"Tidak dapat terhubung ke server. Periksa koneksi internet Anda":t.message||"Terjadi kesalahan saat mengirim laporan";this.$message.error(e)}finally{this.isSubmitting=!1}},resetForm(){this.reportForm={name:"",time:"",place:"",category:"",description:"",information:"",item:"",status:"Open"},this.setCurrentDateTime()},validateForm(){const t=["name","time","place","category","description"];for(let e of t)if(!this.reportForm[e])return this.$message.error(`${e} harus diisi`),!1;return!0}}},l=n,m=r(1656),u=(0,m.A)(l,a,o,!1,null,"680c20e0",null),p=u.exports}}]);
//# sourceMappingURL=create-report.a8b2204d.js.map