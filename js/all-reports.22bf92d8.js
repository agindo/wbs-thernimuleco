"use strict";(self["webpackChunkwbs_2025"]=self["webpackChunkwbs_2025"]||[]).push([[334],{7414:function(t,e,s){s.r(e),s.d(e,{default:function(){return g}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"all-reports"},[e("div",{staticClass:"page-header mb-6"},[e("div",{staticClass:"flex justify-between items-center"},[t._m(0),e("div",{staticClass:"flex items-center space-x-4"},[e("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"Urutkan berdasarkan",size:"small"},on:{change:function(e){return t.fetchReports()}},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},[e("el-option",{attrs:{label:"Tanggal Dibuat",value:"createdAt"}}),e("el-option",{attrs:{label:"Tanggal Update",value:"updatedAt"}}),e("el-option",{attrs:{label:"Nama Laporan",value:"name"}}),e("el-option",{attrs:{label:"Status",value:"status"}})],1),e("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"Arah",size:"small"},on:{change:function(e){return t.fetchReports()}},model:{value:t.sortDir,callback:function(e){t.sortDir=e},expression:"sortDir"}},[e("el-option",{attrs:{label:"Terbaru",value:"desc"}}),e("el-option",{attrs:{label:"Terlama",value:"asc"}})],1),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:function(e){return t.fetchReports()}}},[t._v(" Refresh ")])],1)])]),t.loading?e("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[e("div",{staticClass:"text-center py-12"},[e("Icon",{staticClass:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4",attrs:{icon:"lucide:loader-2"}}),e("p",{staticClass:"text-gray-600"},[t._v("Memuat semua laporan...")])],1)]):t.error?e("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[e("div",{staticClass:"text-center py-12"},[e("Icon",{staticClass:"w-12 h-12 text-red-500 mx-auto mb-4",attrs:{icon:"lucide:alert-circle"}}),e("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[t._v("Gagal Memuat Data")]),e("p",{staticClass:"text-gray-600 mb-4"},[t._v(t._s(t.error))]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.fetchReports()}}},[t._v(" Coba Lagi ")])],1)]):t.reports.length>0?e("div",{staticClass:"space-y-4"},[e("div",{staticClass:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},[e("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"flex-shrink-0"},[e("Icon",{staticClass:"h-8 w-8 text-blue-600",attrs:{icon:"mdi:file-document-multiple"}})],1),e("div",{staticClass:"ml-3"},[e("p",{staticClass:"text-sm font-medium text-gray-500"},[t._v("Total Laporan")]),e("p",{staticClass:"text-2xl font-semibold text-gray-900"},[t.statisticsLoading?e("span",[t._v("...")]):e("span",[t._v(t._s(t.statistics.totalActiveReports||0))])])])])]),e("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"flex-shrink-0"},[e("Icon",{staticClass:"h-8 w-8 text-yellow-600",attrs:{icon:"mdi:clock-outline"}})],1),e("div",{staticClass:"ml-3"},[e("p",{staticClass:"text-sm font-medium text-gray-500"},[t._v("Pending")]),e("p",{staticClass:"text-2xl font-semibold text-gray-900"},[t._v(t._s(t.getStatusCount("pending")))])])])]),e("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"flex-shrink-0"},[e("Icon",{staticClass:"h-8 w-8 text-blue-600",attrs:{icon:"mdi:progress-check"}})],1),e("div",{staticClass:"ml-3"},[e("p",{staticClass:"text-sm font-medium text-gray-500"},[t._v("Process")]),e("p",{staticClass:"text-2xl font-semibold text-gray-900"},[t._v(t._s(t.getStatusCount("process")))])])])]),e("div",{staticClass:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"flex-shrink-0"},[e("Icon",{staticClass:"h-8 w-8 text-green-600",attrs:{icon:"mdi:check-circle"}})],1),e("div",{staticClass:"ml-3"},[e("p",{staticClass:"text-sm font-medium text-gray-500"},[t._v("Completed")]),e("p",{staticClass:"text-2xl font-semibold text-gray-900"},[t._v(t._s(t.getStatusCount("completed")))])])])])]),t._l(t.reports,function(s){return e("div",{key:s.id,staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow"},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"flex-1 border-r mr-2"},[e("div",{staticClass:"flex items-center gap-3"},[e("h3",{staticClass:"text-lg font-semibold text-gray-900"},[t._v(t._s(t.getFieldValue(s,"name","nama","title")))]),e("span",{staticClass:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full"},[t._v(" "+t._s(t.getFieldValue(s,"code","kode")||`#${s.id}`)+" ")]),e("span",{staticClass:"px-2 py-1 text-xs font-medium rounded-full",class:t.getStatusClass(t.getFieldValue(s,"status","state"))},[t._v(" "+t._s(t.getFieldValue(s,"status","state"))+" ")])]),e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 my-3"},[e("div",{staticClass:"space-y-1"},[e("div",{staticClass:"flex items-center text-sm text-gray-600"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:account"}}),e("span",[e("p",{staticClass:"text-indigo-700 text-xs font-mono"},[t._v(t._s(s.createdBy))])])],1),e("div",{staticClass:"flex items-center text-sm text-gray-600"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:map-marker"}}),e("span",[t._v(t._s(t.getFieldValue(s,"place","lokasi","location")))])],1),e("div",{staticClass:"flex items-center text-sm text-gray-600"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:tag"}}),e("span",[t._v(t._s(t.getFieldValue(s,"category","kategori","type")))])],1)]),e("div",{staticClass:"space-y-1"},[e("div",{staticClass:"flex items-center text-sm text-gray-600"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:calendar-plus"}}),e("span",[t._v("Dibuat: "+t._s(t.formatDateTime(t.getFieldValue(s,"createdAt","created_at"))))])],1),t.getFieldValue(s,"updatedAt","updated_at")!==t.getFieldValue(s,"createdAt","created_at")?e("div",{staticClass:"flex items-center text-sm text-gray-600"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"mdi:calendar-edit"}}),e("span",[t._v("Update: "+t._s(t.formatDateTime(t.getFieldValue(s,"updatedAt","updated_at"))))])],1):t._e()])]),e("div",[e("p",{staticClass:"text-sm text-gray-600 line-clamp-2"},[t._v(t._s(t.getFieldValue(s,"description","deskripsi")))])])]),e("div",{staticClass:"flex flex-col gap-2 ml-2"},[e("div",[e("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-view"},on:{click:function(e){return t.viewReportDetailModal(s)}}},[t._v(" Detail ")])],1),e("div",[e("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.editReportStatus(s)}}},[t._v(" Status ")])],1),e("div",[e("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.deleteReport(s)}}},[t._v(" Hapus ")])],1)])])])}),e("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mt-6"},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"text-sm text-gray-700"},[t._v(" Menampilkan "+t._s(t.pagination.page*t.pagination.size+1)+" - "+t._s(Math.min((t.pagination.page+1)*t.pagination.size,t.pagination.totalElements))+" dari "+t._s(t.pagination.totalElements)+" laporan ")]),e("el-pagination",{attrs:{"current-page":t.pagination.page+1,"page-size":t.pagination.size,total:t.pagination.totalElements,layout:"prev, pager, next","hide-on-single-page":t.pagination.totalPages<=1},on:{"current-change":t.changePage}})],1)])],2):e("div",{staticClass:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[e("div",{staticClass:"text-center py-12"},[e("Icon",{staticClass:"text-6xl text-gray-400 mb-4",attrs:{icon:"mdi:file-document-multiple-outline"}}),e("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[t._v("Belum Ada Laporan")]),e("p",{staticClass:"text-gray-600"},[t._v("Belum ada laporan yang tersedia dalam sistem")])],1)]),e("el-dialog",{attrs:{visible:t.showDetailModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"60%","custom-class":"report-detail-modal",top:"20px"},on:{"update:visible":function(e){t.showDetailModal=e},close:t.closeDetailModal}},[e("div",{staticClass:"flex items-center",attrs:{slot:"title"},slot:"title"},[e("Icon",{staticClass:"mr-2 text-blue-600",attrs:{icon:"mdi:file-document"}}),e("span",{staticClass:"text-lg font-semibold"},[t._v("Detail Laporan")])],1),t.detailLoading?e("div",{staticClass:"text-center py-12"},[e("Icon",{staticClass:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4",attrs:{icon:"lucide:loader-2"}}),e("p",{staticClass:"text-gray-600"},[t._v("Memuat detail laporan...")])],1):t.detailError?e("div",{staticClass:"text-center py-12"},[e("Icon",{staticClass:"w-12 h-12 text-red-500 mx-auto mb-4",attrs:{icon:"lucide:alert-circle"}}),e("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[t._v("Gagal Memuat Detail")]),e("p",{staticClass:"text-gray-600 mb-4"},[t._v(t._s(t.detailError))]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.fetchReportDetail(t.selectedReportId)}}},[t._v(" Coba Lagi ")])],1):t.selectedReportDetail?e("div",{staticClass:"report-detail-content"},[e("div",{staticClass:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-lg mb-6"},[e("div",{staticClass:"flex items-start justify-between"},[e("div",{staticClass:"flex-1"},[e("h2",{staticClass:"text-xl font-bold mb-2"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"name","nama","title")))]),e("div",{staticClass:"flex items-center space-x-4 text-blue-100"},["-"!==t.getFieldValue(t.selectedReportDetail,"code","kode")?e("div",{staticClass:"flex items-center"},[e("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:bookmark-outline"}}),e("span",{staticClass:"text-sm"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"code","kode")))])],1):t._e(),e("div",{staticClass:"flex items-center"},[e("Icon",{staticClass:"w-4 h-4 mr-1",attrs:{icon:"mdi:calendar-clock"}}),e("span",{staticClass:"text-sm"},[t._v(t._s(t.formatDateTime(t.getFieldValue(t.selectedReportDetail,"time","tanggal_waktu","datetime"))))])],1)])]),e("div",{staticClass:"text-right"},[e("span",{staticClass:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium shadow-sm",class:t.getDetailStatusClass(t.getFieldValue(t.selectedReportDetail,"status","state"))},[e("Icon",{staticClass:"w-2 h-2 mr-2",attrs:{icon:"mdi:circle"}}),t._v(" "+t._s(t.getFieldValue(t.selectedReportDetail,"status","state"))+" ")],1)])])]),e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},[e("div",{staticClass:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200"},[e("div",{staticClass:"flex items-center mb-2"},[e("div",{staticClass:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:account"}})],1),e("h3",{staticClass:"font-medium text-green-800"},[t._v("Pelapor")])]),e("p",{staticClass:"text-indigo-700 ml-11 font-mono"},[t._v(t._s(t.selectedReportDetail.createdBy))])]),e("div",{staticClass:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200"},[e("div",{staticClass:"flex items-center mb-2"},[e("div",{staticClass:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:map-marker"}})],1),e("h3",{staticClass:"font-medium text-purple-800"},[t._v("Lokasi Kejadian")])]),e("p",{staticClass:"text-purple-700 ml-11"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"place","lokasi","location")))])]),e("div",{staticClass:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-lg border border-yellow-200"},[e("div",{staticClass:"flex items-center mb-2"},[e("div",{staticClass:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:tag"}})],1),e("h3",{staticClass:"font-medium text-yellow-800"},[t._v("Kategori")])]),e("p",{staticClass:"text-yellow-700 ml-11 font-medium"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"category","kategori","type")))])]),e("div",{staticClass:"bg-gradient-to-br from-indigo-50 to-indigo-100 p-4 rounded-lg border border-indigo-200"},[e("div",{staticClass:"flex items-center mb-2"},[e("div",{staticClass:"w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:identifier"}})],1),e("h3",{staticClass:"font-medium text-indigo-800"},[t._v("ID Laporan")])]),e("p",{staticClass:"text-indigo-700 ml-11 font-mono"},[t._v(t._s(t.selectedReportDetail.id))])])]),e("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-5 rounded-lg border border-gray-200 mb-6"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:text-box"}})],1),e("h3",{staticClass:"font-medium text-gray-800"},[t._v("Deskripsi Laporan")])]),e("div",{staticClass:"ml-11"},[e("p",{staticClass:"text-gray-700 leading-relaxed whitespace-pre-wrap"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"description","deskripsi","detail")))])])]),e("div",{staticClass:"grid grid-cols-1 gap-4 mb-6"},["-"!==t.getFieldValue(t.selectedReportDetail,"information","informasi_tambahan")&&t.getFieldValue(t.selectedReportDetail,"information","informasi_tambahan")?e("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:information"}})],1),e("h3",{staticClass:"font-medium text-gray-800"},[t._v("Informasi Tambahan")])]),e("p",{staticClass:"text-gray-700 ml-11 leading-relaxed whitespace-pre-wrap"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"information","informasi_tambahan")))])]):t._e(),"-"!==t.getFieldValue(t.selectedReportDetail,"item","barang")&&t.getFieldValue(t.selectedReportDetail,"item","barang")?e("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:package-variant"}})],1),e("h3",{staticClass:"font-medium text-gray-800"},[t._v("Barang Terkait")])]),e("p",{staticClass:"text-gray-700 ml-11"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"item","barang")))])]):t._e(),"-"!==t.getFieldValue(t.selectedReportDetail,"attachment","lampiran")&&t.getFieldValue(t.selectedReportDetail,"attachment","lampiran")?e("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:paperclip"}})],1),e("h3",{staticClass:"font-medium text-gray-800"},[t._v("Lampiran")])]),e("p",{staticClass:"text-gray-700 ml-11"},[t._v(t._s(t.getFieldValue(t.selectedReportDetail,"attachment","lampiran")))])]):t._e()]),t.selectedReportDetail.evidences&&t.selectedReportDetail.evidences.length>0?e("div",{staticClass:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-lg border border-red-200 mb-6"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:paperclip"}})],1),e("h3",{staticClass:"font-medium text-red-800"},[t._v("Bukti Pendukung ("+t._s(t.selectedReportDetail.evidences.length)+")")])]),e("div",{staticClass:"ml-11"},[e("div",{staticClass:"space-y-3"},t._l(t.selectedReportDetail.evidences,function(s,a){return e("div",{key:s.id||a,staticClass:"evidence-item-enhanced flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors"},[e("div",{staticClass:"flex items-center space-x-3"},[e("Icon",{staticClass:"w-5 h-5 text-red-600",attrs:{icon:t.getFileIcon(s.filename||s.fileName)}}),e("div",[e("p",{staticClass:"text-sm font-medium text-red-800"},[t._v(t._s(s.filename||s.fileName||`Bukti ${a+1}`))]),s.description?e("p",{staticClass:"text-xs text-red-600"},[t._v(t._s(s.description))]):t._e()])],1),e("div",{staticClass:"evidence-actions flex items-center space-x-2"},[t.isImageFile(s.filename||s.fileName)?e("el-button",{staticClass:"text-purple-500 hover:text-purple-700",attrs:{type:"text",size:"mini",icon:"el-icon-view",title:"View image"},on:{click:function(e){return t.viewEvidenceFile(s)}}}):t._e(),e("el-button",{staticClass:"text-green-500 hover:text-green-700",attrs:{type:"text",size:"mini",icon:t.evidenceDownloading[s.id]?"el-icon-loading":"el-icon-download",loading:t.evidenceDownloading[s.id],disabled:t.evidenceDownloading[s.id],title:"Download evidence"},on:{click:function(e){return t.downloadEvidenceFile(s)}}})],1)])}),0)])]):t._e(),e("div",{staticClass:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200"},[e("div",{staticClass:"flex items-center mb-3"},[e("div",{staticClass:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center mr-3"},[e("Icon",{staticClass:"w-4 h-4 text-white",attrs:{icon:"mdi:timeline-clock"}})],1),e("h3",{staticClass:"font-medium text-gray-800"},[t._v("Timeline")])]),e("div",{staticClass:"ml-11 space-y-2"},[e("div",{staticClass:"flex items-center text-sm text-gray-700"},[e("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:clock-outline"}}),e("span",{staticClass:"font-medium"},[t._v("Dibuat:")]),e("span",{staticClass:"ml-2"},[t._v(t._s(t.formatDateTime(t.getFieldValue(t.selectedReportDetail,"createdAt","created_at"))))])],1),t.getFieldValue(t.selectedReportDetail,"updatedAt","updated_at")!==t.getFieldValue(t.selectedReportDetail,"createdAt","created_at")?e("div",{staticClass:"flex items-center text-sm text-emerald-700"},[e("Icon",{staticClass:"w-4 h-4 mr-2",attrs:{icon:"mdi:clock-edit-outline"}}),e("span",{staticClass:"font-medium"},[t._v("Terakhir Diupdate:")]),e("span",{staticClass:"ml-2"},[t._v(t._s(t.formatDateTime(t.getFieldValue(t.selectedReportDetail,"updatedAt","updated_at"))))])],1):t._e()])])]):t._e(),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDetailModal}},[t._v("Tutup")]),e("el-button",{attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(e){return t.editReportStatus(t.selectedReportDetail)}}},[t._v(" Edit Status ")]),e("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.deleteReportFromModal(t.selectedReportDetail)}}},[t._v(" Hapus Laporan ")])],1)]),e("el-dialog",{attrs:{visible:t.showDeleteModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"35%","custom-class":"delete-confirmation-modal",top:"20px"},on:{"update:visible":function(e){t.showDeleteModal=e},close:t.closeDeleteModal}},[e("div",{staticClass:"flex items-center",attrs:{slot:"title"},slot:"title"},[e("Icon",{staticClass:"mr-2 text-red-600",attrs:{icon:"mdi:delete-alert"}}),e("span",{staticClass:"text-lg font-semibold"},[t._v("Konfirmasi Hapus Laporan")])],1),t.reportToDelete?e("div",{staticClass:"delete-modal-content"},[e("div",{staticClass:"text-center mb-6"},[e("div",{staticClass:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[e("Icon",{staticClass:"w-8 h-8 text-red-600",attrs:{icon:"mdi:alert-circle"}})],1),e("h3",{staticClass:"text-lg font-medium text-gray-900 mb-2"},[t._v("Hapus Laporan Permanen")]),e("p",{staticClass:"text-sm text-gray-600"},[t._v(" Tindakan ini tidak dapat dibatalkan. Data laporan akan dihapus secara permanen dari sistem. ")])]),e("div",{staticClass:"bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-lg p-4 mb-6"},[e("div",{staticClass:"flex items-start space-x-3"},[e("div",{staticClass:"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0"},[e("Icon",{staticClass:"w-5 h-5 text-white",attrs:{icon:"mdi:file-document"}})],1),e("div",{staticClass:"flex-1 min-w-0"},[e("h4",{staticClass:"text-sm font-medium text-red-900 mb-1"},[t._v(" "+t._s(t.getFieldValue(t.reportToDelete,"name","nama","title"))+" ")]),e("div",{staticClass:"space-y-1"},["-"!==t.getFieldValue(t.reportToDelete,"code","kode")?e("div",{staticClass:"flex items-center text-xs text-red-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:bookmark-outline"}}),e("span",[t._v(t._s(t.getFieldValue(t.reportToDelete,"code","kode")))])],1):t._e(),e("div",{staticClass:"flex items-center text-xs text-red-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:account"}}),e("p",{staticClass:"text-indigo-700 text-xs font-mono"},[t._v(t._s(t.reportToDelete.createdBy))])],1),e("div",{staticClass:"flex items-center text-xs text-red-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:map-marker"}}),e("span",[t._v(t._s(t.getFieldValue(t.reportToDelete,"place","lokasi","location")))])],1)])]),e("div",{staticClass:"flex-shrink-0"},[e("span",{staticClass:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",class:t.getDetailStatusClass(t.getFieldValue(t.reportToDelete,"status","state"))},[t._v(" "+t._s(t.getFieldValue(t.reportToDelete,"status","state"))+" ")])])])]),e("div",{staticClass:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6"},[e("div",{staticClass:"flex items-start space-x-3"},[e("Icon",{staticClass:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",attrs:{icon:"mdi:information-outline"}}),e("div",{staticClass:"text-sm text-gray-700"},[e("p",{staticClass:"font-medium mb-1"},[t._v("Yang akan dihapus:")]),e("ul",{staticClass:"list-disc list-inside space-y-1 text-xs"},[e("li",[t._v("Data laporan dan semua informasinya")]),e("li",[t._v("Lampiran dan bukti pendukung")]),e("li",[t._v("Riwayat aktivitas terkait laporan")]),e("li",[t._v("Komentar dan feedback")])])])],1)]),e("div",{staticClass:"text-center"},[e("p",{staticClass:"text-sm font-medium text-gray-900 mb-2"},[t._v(" Apakah Anda yakin ingin menghapus laporan ini? ")]),e("p",{staticClass:"text-xs text-gray-600"},[t._v(' Ketik "HAPUS" di bawah untuk mengkonfirmasi penghapusan ')]),e("el-input",{staticClass:"mt-3",attrs:{placeholder:"Ketik HAPUS untuk konfirmasi",size:"small",maxlength:"5","show-word-limit":""},model:{value:t.deleteConfirmationText,callback:function(e){t.deleteConfirmationText=e},expression:"deleteConfirmationText"}})],1)]):t._e(),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{disabled:t.deleteLoading},on:{click:t.closeDeleteModal}},[t._v(" Batal ")]),e("el-button",{attrs:{type:"danger",loading:t.deleteLoading,disabled:"HAPUS"!==t.deleteConfirmationText,icon:"el-icon-delete"},on:{click:t.confirmDeleteReport}},[t._v(" "+t._s(t.deleteLoading?"Menghapus...":"Ya, Hapus Laporan")+" ")])],1)]),e("el-dialog",{attrs:{visible:t.showStatusModal,"close-on-click-modal":!1,"close-on-press-escape":!0,width:"40%","custom-class":"status-update-modal",top:"20px"},on:{"update:visible":function(e){t.showStatusModal=e},close:t.closeStatusModal}},[e("div",{staticClass:"flex items-center",attrs:{slot:"title"},slot:"title"},[e("Icon",{staticClass:"mr-2 text-orange-600",attrs:{icon:"mdi:clipboard-edit"}}),e("span",{staticClass:"text-lg font-semibold"},[t._v("Update Status Laporan")])],1),t.reportToUpdateStatus?e("div",{staticClass:"status-modal-content"},[e("div",{staticClass:"bg-gradient-to-r from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-4 mb-6"},[e("div",{staticClass:"flex items-start space-x-3"},[e("div",{staticClass:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0"},[e("Icon",{staticClass:"w-5 h-5 text-white",attrs:{icon:"mdi:file-document"}})],1),e("div",{staticClass:"flex-1 min-w-0"},[e("h4",{staticClass:"text-sm font-medium text-orange-900 mb-1"},[t._v(" "+t._s(t.getFieldValue(t.reportToUpdateStatus,"name","nama","title"))+" ")]),e("div",{staticClass:"space-y-1"},["-"!==t.getFieldValue(t.reportToUpdateStatus,"code","kode")?e("div",{staticClass:"flex items-center text-xs text-orange-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:bookmark-outline"}}),e("span",[t._v(t._s(t.getFieldValue(t.reportToUpdateStatus,"code","kode")))])],1):t._e(),e("div",{staticClass:"flex items-center text-xs text-orange-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:account"}}),e("span",{staticClass:"font-mono"},[t._v(t._s(t.reportToUpdateStatus.createdBy))])],1),e("div",{staticClass:"flex items-center text-xs text-orange-700"},[e("Icon",{staticClass:"w-3 h-3 mr-1",attrs:{icon:"mdi:map-marker"}}),e("span",[t._v(t._s(t.getFieldValue(t.reportToUpdateStatus,"place","lokasi","location")))])],1)])]),e("div",{staticClass:"flex-shrink-0"},[e("span",{staticClass:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",class:t.getDetailStatusClass(t.getFieldValue(t.reportToUpdateStatus,"status","state"))},[t._v(" "+t._s(t.getFieldValue(t.reportToUpdateStatus,"status","state"))+" ")])])])]),e("div",{staticClass:"space-y-4"},[e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[t._v(" Status Baru ")]),e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Pilih status baru",size:"medium",disabled:t.statusLoading},model:{value:t.selectedStatus,callback:function(e){t.selectedStatus=e},expression:"selectedStatus"}},t._l(t.availableStatuses,function(t){return e("el-option",{key:t.id,attrs:{label:t.title,value:t.title}})}),1)],1),e("div",[e("label",{staticClass:"block text-sm font-medium text-gray-700 mb-2"},[t._v(" Alasan Perubahan Status ")]),e("el-input",{attrs:{type:"textarea",placeholder:"Masukkan alasan perubahan status (opsional)",rows:3,maxlength:255,"show-word-limit":"",disabled:t.statusLoading},model:{value:t.selectedReason,callback:function(e){t.selectedReason=e},expression:"selectedReason"}}),e("p",{staticClass:"text-xs text-gray-500 mt-1"},[t._v(" Berikan alasan untuk perubahan status ini (maksimal 255 karakter) ")])],1),t.selectedStatus?e("div",{staticClass:"bg-blue-50 border border-blue-200 rounded-lg p-3"},[e("div",{staticClass:"flex items-start space-x-2"},[e("Icon",{staticClass:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0",attrs:{icon:"mdi:information-outline"}}),e("div",{staticClass:"text-sm text-blue-800"},[e("p",{staticClass:"font-medium mb-1"},[t._v("Deskripsi Status:")]),e("p",{staticClass:"leading-relaxed"},[t._v(t._s(t.getStatusDescription(t.selectedStatus)))])])],1)]):t._e(),t.selectedStatus&&t.selectedStatus!==t.getFieldValue(t.reportToUpdateStatus,"status","state")?e("div",{staticClass:"bg-gray-50 border border-gray-200 rounded-lg p-3"},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"text-center"},[e("p",{staticClass:"text-xs font-medium text-gray-500 mb-1"},[t._v("Status Saat Ini")]),e("span",{staticClass:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",class:t.getDetailStatusClass(t.getFieldValue(t.reportToUpdateStatus,"status","state"))},[t._v(" "+t._s(t.getFieldValue(t.reportToUpdateStatus,"status","state"))+" ")])]),e("Icon",{staticClass:"w-5 h-5 text-gray-400",attrs:{icon:"mdi:arrow-right"}}),e("div",{staticClass:"text-center"},[e("p",{staticClass:"text-xs font-medium text-gray-500 mb-1"},[t._v("Status Baru")]),e("span",{staticClass:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500 text-white"},[t._v(" "+t._s(t.selectedStatus)+" ")])])],1)]):t._e()])]):t._e(),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{disabled:t.statusLoading},on:{click:t.closeStatusModal}},[t._v(" Batal ")]),e("el-button",{attrs:{type:"primary",loading:t.statusLoading,disabled:!t.selectedStatus||t.selectedStatus===t.getFieldValue(t.reportToUpdateStatus,"status","state"),icon:"el-icon-check"},on:{click:t.updateReportStatus}},[t._v(" "+t._s(t.statusLoading?"Mengupdate...":"Update Status")+" ")])],1)]),e("EvidenceViewer",{attrs:{visible:t.showEvidenceViewer,"evidence-data":t.selectedEvidenceForView},on:{"update:visible":function(e){t.showEvidenceViewer=e},close:t.handleEvidenceViewerClose}})],1)},i=[function(){var t=this,e=t._self._c;return e("div",[e("h1",{staticClass:"text-2xl font-bold text-gray-900"},[t._v("Semua Laporan")]),e("p",{staticClass:"text-gray-600"},[t._v("Kelola dan review semua laporan dalam sistem")])])}],l=(s(4114),s(8111),s(2489),s(116),s(8298)),r=s(2399),o=s(1835),n=s(6050),d=s(7215),c={name:"AllReports",components:{Icon:l.In,EvidenceViewer:n.A},data(){return{reports:[],loading:!1,error:null,pagination:{page:0,size:10,totalElements:0,totalPages:0,first:!0,last:!0,empty:!0},sortBy:"createdAt",sortDir:"desc",showDetailModal:!1,selectedReportDetail:null,selectedReportId:null,detailLoading:!1,detailError:null,showDeleteModal:!1,reportToDelete:null,deleteLoading:!1,deleteConfirmationText:"",evidenceDownloading:{},showEvidenceViewer:!1,selectedEvidenceForView:{},showStatusModal:!1,reportToUpdateStatus:null,selectedStatus:"",selectedReason:"Tidak ada",statusLoading:!1,availableStatuses:[],statistics:{totalActiveReports:0},statisticsLoading:!1}},computed:{currentUser(){return this.$store.getters.user||{role:"user"}}},methods:{async fetchReports(){if("admin"===this.currentUser.role||"manager"===this.currentUser.role){this.loading=!0,this.error=null;try{console.log("Fetching all reports for admin...");const t=await r.A.getAllReports(this.pagination.page,this.pagination.size,this.sortBy,this.sortDir);console.log("All reports result:",t),t&&t.content?(this.reports=t.content,this.pagination=t.pagination,console.log("Reports loaded successfully:",this.reports.length,"reports")):(this.reports=[],this.error="Data laporan tidak ditemukan"),this.fetchStatistics()}catch(t){console.error("Error fetching all reports:",t),this.error=t.message||"Gagal memuat data laporan",this.reports=[]}finally{this.loading=!1}}else this.error="Akses ditolak. Anda tidak memiliki izin untuk melihat semua laporan."},async fetchStatistics(){this.statisticsLoading=!0;try{console.log("Fetching reports statistics...");const t=await r.A.getReportsStatistics();console.log("Statistics result:",t),t&&t.success&&t.data?(this.statistics=t.data,console.log("Statistics loaded successfully:",this.statistics)):console.warn("Invalid statistics response:",t)}catch(t){console.error("Error fetching statistics:",t)}finally{this.statisticsLoading=!1}},getFieldValue(t,...e){for(const s of e)if(t&&void 0!==t[s]&&null!==t[s])return t[s];return"-"},getStatusClass(t){const e={Dibatalkan:"bg-red-100 text-red-800",Dikirim:"bg-blue-100 text-blue-800",Disaring:"bg-yellow-100 text-yellow-800","Investigasi Awal":"bg-orange-100 text-orange-800",Dilaporkan:"bg-purple-100 text-purple-800","Investigasi Lanjutan":"bg-indigo-100 text-indigo-800","Buat Tim":"bg-teal-100 text-teal-800","Buat Laporan":"bg-cyan-100 text-cyan-800","Keputusan Terakhir":"bg-green-100 text-green-800"};return e[t]||"bg-gray-100 text-gray-800"},getStatusCount(t){const e=t.toLowerCase();return this.reports.filter(t=>{const s=this.getFieldValue(t,"status","state").toLowerCase();return s===e}).length},formatDateTime(t){if(!t)return"-";try{const e=new Date(t);return isNaN(e.getTime())?t:e.toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return t}},changePage(t){this.pagination.page=t-1,this.fetchReports()},viewReportDetail(t){this.$router.push(`/dashboard/reports/${t.id}`)},async viewReportDetailModal(t){this.selectedReportId=t.id,this.showDetailModal=!0,await this.fetchReportDetail(t.id)},async fetchReportDetail(t){this.detailLoading=!0,this.detailError=null;try{const e=await r.A.getReport(t);this.selectedReportDetail=e.report}catch(e){console.error("Error fetching report detail:",e),this.detailError=e.message||"Gagal memuat detail laporan"}finally{this.detailLoading=!1}},closeDetailModal(){this.showDetailModal=!1,this.selectedReportDetail=null,this.selectedReportId=null,this.detailError=null,this.detailLoading=!1},getDetailStatusClass(t){const e={Dibatalkan:"bg-red-500 text-white",Dikirim:"bg-blue-500 text-white",Disaring:"bg-yellow-500 text-white","Investigasi Awal":"bg-orange-500 text-white",Dilaporkan:"bg-purple-500 text-white","Investigasi Lanjutan":"bg-indigo-500 text-white","Buat Tim":"bg-teal-500 text-white","Buat Laporan":"bg-cyan-500 text-white","Keputusan Terakhir":"bg-green-500 text-white"};return e[t]||"bg-gray-500 text-white"},deleteReportFromModal(t){this.closeDetailModal(),this.deleteReport(t)},editReportStatus(t){this.reportToUpdateStatus=t,this.selectedStatus=this.getFieldValue(t,"status","state")||"",this.showStatusModal=!0},closeStatusModal(){this.showStatusModal=!1,this.reportToUpdateStatus=null,this.selectedStatus="",this.selectedReason="Tidak ada",this.statusLoading=!1},async updateReportStatus(){if(this.selectedStatus){this.statusLoading=!0;try{await r.A.updateReportStatus(this.reportToUpdateStatus.id,this.selectedStatus,this.selectedReason),this.$message.success({message:`Status laporan berhasil diubah menjadi "${this.selectedStatus}"`,duration:3e3,showClose:!0});const t=this.reports.findIndex(t=>t.id===this.reportToUpdateStatus.id);-1!==t&&(this.$set(this.reports[t],"status",this.selectedStatus),this.$set(this.reports[t],"state",this.selectedStatus)),this.selectedReportDetail&&this.selectedReportDetail.id===this.reportToUpdateStatus.id&&(this.$set(this.selectedReportDetail,"status",this.selectedStatus),this.$set(this.selectedReportDetail,"state",this.selectedStatus)),this.closeStatusModal()}catch(t){console.error("Error updating report status:",t),this.$message.error({message:`Gagal mengubah status laporan: ${t.message}`,duration:5e3,showClose:!0})}finally{this.statusLoading=!1}}else this.$message.warning("Silakan pilih status terlebih dahulu")},getStatusDescription(t){const e=this.availableStatuses.find(e=>e.title===t);return e?e.description:""},deleteReport(t){this.reportToDelete=t,this.showDeleteModal=!0,this.deleteConfirmationText=""},closeDeleteModal(){this.showDeleteModal=!1,this.reportToDelete=null,this.deleteLoading=!1,this.deleteConfirmationText=""},async confirmDeleteReport(){if("HAPUS"===this.deleteConfirmationText){this.deleteLoading=!0;try{await r.A.deleteReport(this.reportToDelete.id),this.$message.success({message:`Laporan "${this.getFieldValue(this.reportToDelete,"name","nama","title")}" berhasil dihapus`,duration:3e3,showClose:!0}),this.closeDeleteModal(),await this.fetchReports()}catch(t){console.error("Error deleting report:",t),this.$message.error({message:`Gagal menghapus laporan: ${t.message}`,duration:5e3,showClose:!0})}finally{this.deleteLoading=!1}}else this.$message.warning('Silakan ketik "HAPUS" untuk mengkonfirmasi penghapusan')},async downloadEvidenceFile(t){this.$set(this.evidenceDownloading,t.id,!0);try{console.log("Downloading evidence:",t);const e=await o.A.downloadEvidence(t.id,t.filename||t.fileName);e.success?this.$notify({title:"Download Berhasil",message:`Evidence "${t.filename||t.fileName}" berhasil didownload`,type:"success",duration:3e3,position:"top-right"}):this.$message.error(e.error||"Gagal mendownload evidence")}catch(e){console.error("Error downloading evidence:",e),this.$message.error("Terjadi kesalahan saat mendownload evidence")}finally{this.$delete(this.evidenceDownloading,t.id)}},viewEvidenceFile(t){this.selectedEvidenceForView=t,this.showEvidenceViewer=!0},handleEvidenceViewerClose(){this.showEvidenceViewer=!1,this.selectedEvidenceForView={}},isImageFile(t){if(!t)return!1;const e=[".jpg",".jpeg",".png",".gif",".bmp",".webp"];return e.some(e=>t.toLowerCase().endsWith(e))},getFileIcon(t){if(!t)return"mdi:file-outline";const e=t.toLowerCase().split(".").pop();switch(e){case"pdf":return"mdi:file-pdf-box";case"doc":case"docx":return"mdi:file-word-box";case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return"mdi:file-image-box";case"mp4":case"avi":case"mov":return"mdi:file-video-box";case"zip":case"rar":case"7z":return"mdi:folder-zip-outline";default:return"mdi:file-outline"}}},mounted(){console.log("AllReports component mounted"),this.availableStatuses=d.p||[],this.fetchReports(),this.fetchStatistics()}},u=c,m=s(1656),p=(0,m.A)(u,a,i,!1,null,"1e9d9ff8",null),g=p.exports}}]);
//# sourceMappingURL=all-reports.22bf92d8.js.map